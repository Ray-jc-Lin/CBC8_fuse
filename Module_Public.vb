'D1	S12磅秤1實際值
'D2	S2磅秤2實際值
'D3	G12磅秤3實際值
'D4	G2磅秤4實際值
'D5	G3磅秤5實際值
'D6	W123磅秤6實際值
'D7	C12磅秤7實際值
'D8	C2磅秤8實際值
'D9	C3磅秤9實際值
'D10	C4磅秤10實際值
'D11	C5磅秤11實際值
'D12	A1磅秤12實際值
'D13	A2磅秤13實際值
'D14	A3磅秤14實際值
'D15	A4磅秤15實際值
'D16	運轉狀況1
'D17	運轉狀況2
'D18	運轉狀況3
'D19	運轉狀況4

'D20	實際骨材盤次
'D21	實際泥料盤次
'D22	列印開始=1
'D23	實際拌合時間
'D24	拌合排料時間
'D25	拌合機電流一
'D26	待拌槽1開時間
'D27	待拌槽1閉時間
'D28	待拌槽2開時間
'D29	運轉狀況5(閘門失誤)
'D30	狀態D1(骨材計量)
'D31	狀態D2(泥料計量)
'D32	狀態D3(磅秤放料)
'D33	狀態D4(骨材計量完成中)
'D34	狀態D5(泥料計量完成中)     *NonAuto=16384
'D35	狀態D6(磅秤空磅值下)
'D36	狀態D7(運轉情形)                 D36 bit1 '104.8.27 DV(36) bit 1 自動中 for 連線中 不可切換回
'D37	運轉狀況6(骨材入倉)
'D38	狀態D9(骨材超量bit)
'D39	狀態D10(泥料超量bit)
'D40	運轉狀況7(泥料入倉)

'D41	磅秤1現在值(骨材)
'D42	磅秤2現在值(骨材)
'D43	磅秤3現在值(骨材)
'D44	磅秤4現在值(骨材)
'D45	磅秤5現在值(骨材)
'D46	磅秤6現在值(水)
'D47	磅秤7現在值(水泥)
'D48	磅秤8現在值(水泥)
'D49	磅秤9現在值(水泥)
'D50	磅秤10現在值(水泥)
'D51	磅秤11現在值(水泥)
'D52	磅秤12現在值(藥)
'D53	磅秤13現在值(藥)
'D54	磅秤14現在值(藥)
'D55	磅秤15現在值(藥)

'D61	S1修正印出值
'D62	S2修正印出值
'D63	S3修正印出值
'D64	S4修正印出值
'D65	G1修正印出值
'D66	G2修正印出值
'D67	G3修正印出值
'D68	G4修正印出值
'D69	
'D70	W1修正印出值
'D71	W2修正印出值
'D72	W3修正印出值
'D73	C1修正印出值
'D74	C2修正印出值
'D75	C3修正印出值
'D76	C4修正印出值
'D77	C5修正印出值
'D78	C6修正印出值
'D79	A1修正印出值
'D80	A2修正印出值
'D81	A3修正印出值
'D82	A4修正印出值
'D83	A5修正印出值
'D84	備有
'D85	備有

'D91	S1印出真值
'D92	S2印出真值
'D93	S3印出真值
'D94	S4印出真值
'D95	G1印出真值
'D96	G2印出真值
'D97	G3印出真值
'D98	G4印出真值
'D99	
'D100	W1印出真值
'D101	W2印出真值
'D102	W3印出真值
'D103	C1印出真值
'D104	C2印出真值
'D105	C3印出真值
'D106	C4印出真值
'D107	C5印出真值
'D108	C6印出真值
'D109	A1印出真值
'D110	A2印出真值
'D111	A3印出真值
'D112	A4印出真值
'D113	A5印出真值
'D114	備有
'D115	備有

'D161	S1殘留值
'D162	S2殘留值
'D163	S3殘留值
'D164	S4殘留值
'D165	G1殘留值
'D166	G2殘留值
'D167	G3殘留值
'D168	G4殘留值
'D169	
'D170	W1殘留值
'D171	W2殘留值
'D172	W3殘留值
'D173	C1殘留值
'D174	C2殘留值
'D175	C3殘留值
'D176	C4殘留值
'D177	C5殘留值
'D178	C6殘留值
'D179	A1殘留值
'D180	A2殘留值
'D181	A3殘留值
'D182	A4殘留值
'D183	A5殘留值

'D401	磅秤1滿刻度值(骨材)        D421	磅秤1歸零內值(骨材)    D441	磅秤1校準內值(骨材)    D461	磅秤1放料順序(骨材)
'D402	磅秤2滿刻度值(骨材)
'D403	磅秤3滿刻度值(骨材)
'D404	磅秤4滿刻度值(骨材)
'D405	磅秤5滿刻度值(骨材)
'D406	磅秤6滿刻度值(水)
'D407	磅秤7滿刻度值(水泥)
'D408	磅秤8滿刻度值(水泥)
'D409	磅秤9滿刻度值(水泥)
'D410	磅秤10滿刻度值(水泥)
'D411	磅秤11滿刻度值(水泥)
'D412	磅秤12滿刻度值(藥劑)
'D413	磅秤13滿刻度值(藥劑)
'D414	磅秤14滿刻度值(藥劑)
'D415	磅秤15滿刻度值(藥劑)

'D401	磅秤1滿刻度值(骨材)        
'D421	磅秤1歸零內值(骨材)    
'D441	磅秤1校準內值(骨材)    
'D461	磅秤1放料順序(骨材)
'D481	磅1空磅值(S1)
'D501	磅1空確認時間(S1)
'D521	磅秤1最小刻劃(骨材)

'
'D561	S1落差值
'D562	S2落差值
'D563	S3落差值
'D564	S4落差值
'D565	G1落差值
'D566	G2落差值
'D567	G3落差值
'D568	G4落差值
'D569	
'D570	W1落差值
'D571	W2落差值
'D572	W3落差值
'D573	C1落差值
'D574	C2落差值
'D575	C3落差值
'D576	C4落差值
'D577	C5落差值
'D578	C6落差值
'D579	A1落差值
'D580	A2落差值
'D581	A3落差值
'D582	A4落差值
'D583	A5落差值
'D584	備用
'D585	備用

'D561	S1落差值
'D591	S1寸動提前值
'D621	S1寸動開門時間
'D651	S1寸動閉門時間
'D681	S1計量完成確認時間


'D711	待拌前段放料設定時間
'D712	待拌間歇設定時間
'D713	待拌後段放料設定時間
'D714	砂計量振動ON時間
'D715	砂計量振動OFF時間
'D716	砂放料振動ON時間
'D717	砂放料振動OFF時間
'D718	水泥計量振動ON時間
'D719	水泥計量振動OFF時間
'D720	水泥放料振動ON時間
'D721	水泥放料振動OFF時間
'D722	集塵機ON時間
'D723	集塵機OFF時間
'D724	藥劑1計量限時
'D725	藥劑2計量限時
'D726	藥劑3計量限時
'D727	藥劑4計量限時
'D728	黃油注入時間
'D729	黃油注入週期
'D730	監視視窗延遲
'D731	集塵延遲
'D732	 參數其他設定1
'D733	 參數其他設定2
'D734	 參數其他設定3
'D735	 參數其他設定4
'D736	 參數其他設定5
'D737	 參數其他設定6
'D738	 參數其他設定7
'D739	 參數其他設定8
'D740	 參數其他設定9

'D741	S1設定修正值        D771	S1真設定值
'D742	S2設定修正值
'D743	S3設定修正值
'D744	S4設定修正值
'D745	G1設定修正值
'D746	G2設定修正值
'D747	G3設定修正值
'D748	G4設定修正值
'D749	
'D750	W1設定修正值
'D751	W2設定修正值
'D752	W3設定修正值
'D753	C1設定修正值
'D754	C2設定修正值
'D755	C3設定修正值
'D756	C4設定修正值
'D757	C5設定修正值
'D758	C6設定修正值
'D759	A1設定修正值        D789	A1真設定值
'D760	A2設定修正值        
'D761	A3設定修正值
'D762	A4設定修正值
'D763	A5設定修正值
'D764	備有
'D765	備有

'D767	A配比預留(與方數無關)1
'D768	A配比預留(與方數無關)2
'D769	A配比預留(與方數無關)3
'D770	A配比預留(與方數無關)4

'D801	S1超量%         D841	S1不足量%         D871	S1殘留值高限
'D802	S2超量%
'D803	S3超量%
'D804	S4超量%
'D805	G1超量%
'D806	G2超量%
'D807	G3超量%
'D808	G4超量%
'D809	
'D810	W1超量%
'D811	W2超量%
'D812	W3超量%
'D813	C1超量%
'D814	C2超量%
'D815	C3超量%
'D816	C4超量%
'D817	C5超量%
'D818	C6超量%
'D819	A1超量%
'D820	A2超量%
'D821	A3超量%
'D822	A4超量%
'D823	A5超量%
'D824	備有
'D825	備有

'D826	拌合時間設定(本盤)
'D829   排隊一 有配比 通知節能用    107.6.11
'D830	顯示切換=1 (真)
'D831	校磅中=1
'D832	拌合時間設定
'D833	拌合次數設定
'D834	排料時間設定
'D835	搶先中
'D836	顯示值=印出值
'D837	殘留值高限旗標
'D838   變更米數
'D839   "開始"有料提醒
'D840   




Module Module_Public
    '99.10.28 site
    '99.10.03 site report shink 2
    '99.10.13 
    '               COM buffer 1024-> 2048 for unknow error
    '                If SiloMatType1(i + 1) = "S" Or SiloMatType1(i + 1) = "G" Then (site) for color

    '111.11.30 列印調整 
    Public mat_offset(25) As Single
    Public mat_offset_sp(25) As Single
    Public mat_offset_tot As Single

    '111.11.10 指定列印
    Public bCheckBoxSP19CheckBoxsSim As Boolean
    '111.10.20
    Public datefind As String
    '111.7.22
    '   模擬報表 首盤 CheckBoxFirstPan
    Public bCheckBoxFirstPan As Boolean

    '110.9.11 110.8.1@h
    Public bMyComputerNetworkIsAvailable As Boolean
    Public bMyComputerNetworkPingDataBaseIP As Boolean
    Public bMyComputerNetworkPingTextBoxIP_R As Boolean

    '110.4.22 bPbSync 上線後 BUG
    Public Queryfomula_ID As Integer
    '110.4.8
    Public Cbxquecode1_Cnt As Integer
    Public Cbxquecode1_NoText_Cnt As Integer
    Public D839_Cnt As Integer
    Public D839_No_Cnt As Integer

    '109.12.6 配比連線
    Public objDownloadAerp As New classDownloadAerp
    '109.12.25 配比連線
    Public objUpAerp As New classUploadAerp

    '109.4.26 配比連線
    Public sCompid As String = "JS"
    Public sFactid As String = "01"  '???

    '109.4.2 配比連線
    Public fommula_Mdb As New ClassFomula
    Public fommula_Mdf As New ClassFomula

    '109.8.15 台泥台南 Q38  bQ38=true and after case C12345
    Public bQ38 As Boolean

    '108.2.27 台泥南崁(嘉利) Q36  bQ36=true
    Public bQ36 As Boolean

    '109.8.17 台泥豐原(財石) Q32  bQ32=true for C12345
    Public bQ32 As Boolean

    '107.8.10
    Public RemainDonePlate_MoveA As Integer
    Public UniCar_MoveA As String
    '107.6.2 for Background threading4
    Public iCarSerToday As Integer  '車次顯示
    Public WithEvents Label_PLC_D20 As New Label_PLC_D
    Public WithEvents Label_PLC_D21 As New Label_PLC_D
    Public WithEvents Label_PLC_D22 As New Label_PLC_D

    '107.4.14 for Background threading
    Public BackgroundThread1 As New BackgroundThread
    Public BackgroundThread2 As New BackgroundThread
    Public BackgroundThread3 As New BackgroundThread
    Public Background1_Sql As String
    Public Background2_Sql As String
    Public Background1_Flag As Boolean
    Public Background2_Flag As Boolean
    Public iBackground3_Flag As Integer
    Public iBackground3_ModDone As Integer
    Public sBackground3_UniCar As String
    Public fBackground3_cube As Single
    Public carsum As Single
    Public daysum As Single
    Public monthsum As Single
    Public MachTot As Single

    '107.4.11
    'Public MonitTimer2Cnt As Long
    '107.3.8 for DV .tlg
    Public TLog As New TraceLog
    '107.3.8 for old TraceLog .lg2
    Public MonLog As New TraceLog
    '107.3.18 for old TraceLog .lg2
    Public MainLog As New TraceLog
    Public DbLog As New TraceLog
    '109.4.2 配比連線 bPbSync
    Public UploadPbLog As New TraceLog
    '111.10.21 rec連線 
    Public RecSqlLog As New TraceLog

    '110.1.30
    Public WithEvents D_01 As New PLC_DV

    '107.3.7
    Public WithEvents D_20 As New PLC_DV
    Public WithEvents D_21 As New PLC_DV
    Public WithEvents D_22 As New PLC_DV
    '107.4.28
    Public WithEvents D_32 As New PLC_DV_Status
    Public WithEvents D_35 As New PLC_DV_Status

    '107.1.31 台泥RS232通信旗標
    Public sPlcCom2 As String
    Public bCheckBox232 As Boolean         'true:have COM false no COM
    Public bCheckBoxA As Boolean         'true:傳送修正值 false 傳送實際值
    Public WithEvents PLC_232_2 As New Rs232
    Public rxACKs As Integer
    Public BatchDone As New ClassBatchDoneTx

    '107.2.11
    Public bNonAuto As Boolean
    Enum ASCII As Byte
        STX = 2
        ETX = 3
        EOT = 4
        ENQ = 5
        ACK = 6
        SP = 32
        QUOTE = 96
    End Enum
    '107.6.22 use by thread must public move from mainform
    ''99.12.09
    Public sbujiq1a As String
    '107.6.16
    Public iTimer As Double
    Public iTimerMixer As Double
    Public bTimerMixerSetFlag As Boolean
    Public iTimerConveyer As Double
    Public bTimerConveyerSetFlag As Boolean
    '106.12.10 TimerLink error
    Public TimerLinkErrorCnt As Integer          'COM_PLC.ReadDvNumber(i)  

    '106.11.10 ref 土城
    '105.12.27
    Public fMinWaterPer As Single         '最小含水率
    '105.11.15
    Public fMaxWaterPer As Single         '最大含水率
    Public water_all_W_Limit(7) As Single

    '106.10.7 聯佶空單
    Public MixynIng As Boolean  '空單confirmed

    '106.9.4 for SQL
    Public Re_SendSQL_Flag As Boolean

    '106.7.22 亞東 自動補傳 : Transed : 工控寫入(A：自動補傳、H：手動補傳)
    Public sTransed As String     '

    '106.1.2 
    Public bLastPlateBySql As Boolean ' for CheckRemoteBfile by SendSQL
    '105.12.23
    Public SQLyymodd As String     'for confirm SQL 
    Public SQLhhmmss As String     'for confirm SQL un
    '105.11.3
    Public ReadDvPointer As Integer          'COM_PLC.ReadDvNumber(i)  
    '105.9.24
    Public bNetworkIsAvailable As Boolean          'Computer.Network.IsAvailable 
    Public bPingSQL As Boolean          'Computer.Network.IsAvailable sTextBoxIP_R
    Public bPingRPC As Boolean  'Computer.Network.IsAvailable sDataBaseIP
    '112.1.5 遠傳大數據
    Public bBigData As Boolean
    Public bPingSQLBigData As Boolean 'Computer.Network.IsAvailable sTextBoxIP_R
    '112.3.30
    Public bTextBoxSPARE5 As Boolean 'if TextBoxSPARE5 ="" = false 連接大數據資料庫
    Public sBigDataDataBaseIP As String        '大數據電腦IP TextBoxSPARE5
    '105.9.3
    Public bCheckBoxsSim As String     '即時列印

    '105.8.14
    Public sRemainUniCar As String = ""     'prevent TimeSQL delay queueP.UniCar maybe updated  
    '105.8.10
    Public s_receia As String = "receia"     '環泥烏日 to 時訊 recei1a 
    '105.7.25
    Public sPBUser As String     'enter PB user name
    '105.6.7
    Public sTextBoxBpath As String     'B formaul save path B存放磁碟(C:,Z:)
    Public sTextBoxSPARE1 As String     'SPARE 遠端A存放磁碟 106.6.30
    Public sRemoteApath As String     'SPARE 遠端A存放磁碟 106.6.30
    Public sTextBoxSPARE2 As String     'SPARE
    Public sTextBoxSPARE3 As String     'SPARE
    Public sTextBoxSPARE4 As String     'SPARE
    Public sTextBoxSPARE5 As String     'SPARE
    '105.9.11 must be bool
    Public bCheckBoxSP4 As Boolean     '105.7.3 資料自動補傳
    Public bCheckBoxSP5 As Boolean     'SPARE
    Public bCheckBoxSP6 As Boolean     'SPARE   環泥烏日 105.7
    Public bCheckBoxSP7 As Boolean     'SPARE   參數存至遠端
    Public bCheckBoxSP8 As Boolean     'SPARE   校磅密碼紀錄 105.10.7
    Public bCheckBoxSP9 As Boolean     'SPARE   配比密碼紀錄 105.10.7
    '105.6.7
    Public bCheckBoxSP10 As Boolean     'SPARE  列印密碼調整
    Public bCheckBoxSP11 As Boolean     'SPARE  可修改首盤時間
    Public bCheckBoxSP12 As Boolean     'SPARE  106.6.8 配件庫存管理
    Public bCheckBoxSP13 As Boolean     'SPARE
    Public bCheckBoxSP14 As Boolean     'SPARE
    Public bCheckBoxSP15 As Boolean     'SPARE  107.12.28 B配也修正 for 巨力

    '107.6.10 
    Public bCheckBoxSP16 As Boolean     'SPARE  109.4.2 配比連線
    Public bPbSync As Boolean           'SPARE  109.4.2 配比連線 only Yadon bCheckBoxYadon

    Public bCheckBoxSP17 As Boolean     'SPARE  
    Public bCheckBoxSP18 As Boolean     'SPARE  110.7.28 列印時間旗標(nouse ) 111.4.6 藥劑%
    Public bCheckBoxSP19 As Boolean     'SPARE  
    Public bCheckBoxSP20 As Boolean     'SPARE
    'Public bCheckBoxSP4 As String     '105.7.3 資料自動補傳
    'Public bCheckBoxSP5 As String     'SPARE
    'Public bCheckBoxSP6 As String     'SPARE 環泥烏日 105.7
    'Public bCheckBoxSP7 As String     'SPARE
    'Public bCheckBoxSP8 As String     'SPARE
    '105.7.19
    Public sTextBoxIP_R As String       '遠端電腦IP
    Public sTextBoxPrj2 As String        '專案編號2
    Public sTextBoxMixerNo2 As String     '拌合機編號2
    Public sTextBoxPrj As String        '專案編號1
    Public sTextBoxMixerNo As String     '拌合機編號1

    '105.9.16
    Public bOnlyLocalPC As Boolean     'bOnlyLocalPC 調度資料伺服器IP sDataBaseIP = 遠端電腦IP sTextBoxIP_R = 127.0.0.1
    '105.7.22
    Public bUseNetwork As Boolean     'if 調度資料伺服器IP sDataBaseIP 遠端電腦IP sTextBoxIP_R 127.0.0.1
    '105.7.17
    Public bLastMonthFile As Boolean     'if last month mdb exist

    '105.7.17
    Public bRadioButton_OP As Boolean     '操作盤
    Public bRadioButton_REMOTE As Boolean     '遠端
    Public bRadioButton_NO1 As Boolean     '一號機
    Public bRadioButton_NO2 As Boolean     '二號機
    '105.7.16
    Public bRemoteBpath As Boolean     'check if remote B exist
    Public bRemoteApath As Boolean     'check if remote B exist
    '105.6.5
    Public bNetPing As Boolean          'Computer.Network.IsAvailable & Computer.Network.Ping(sDataBaseIP)
    '105.6.7
    Public bOutway As String     'outway varchar(1) 類別 A、M


    '100.5.17
    Public truck As New Bitmap("\JS\OrigFile\truck.jpg")
    Public WithEvents queue, queue1 As New product
    Public sim_produce As Boolean  '模擬報表flag
    '100.5.15
    Public sim_TimerCt As Integer  '模擬報表flag
    Public sSite As String  '核示 or　工地

    ' S1 S2 S3 S4 G1 G2 G3 G4 W1 W2 W3 C1 C2 C3 C4 C5 C6 A1 A2 A3 A4 A5
    '  0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21
    Public MatCounts As Integer     '材料used counts
    Public MatSiloNo(28) As Integer     '材料磅號
    Public MatSiloNoFirst(28) As Boolean     '材料磅號 99.12.04 is first Mater of this silo for remain of simulatio
    Public MatUse(28) As Integer     '材料磅號
    Public MatSiloOrder(28) As Integer  '材料磅號料序
    Public MatSiloSR(28) As Integer  '材料料序
    'Public SiloSP(15) As Integer     '磅?setpoint
    Public SiloSP(15) As Single     '磅?setpoint
    Public SiloFullScale(15) As Integer     '磅?FullScale
    Public SiloCounts As Integer '使用磅秤總數
    Public SiloUse(15) As Boolean  '使用磅秤?
    Public SiloCount1 As Integer '使用磅秤總數
    Public SiloUse1(8) As Boolean  '使用磅秤?
    Public SiloCount2 As Integer '使用磅秤總數
    Public SiloUse2(8) As Boolean  '使用磅秤?
    Public SiloMatSer(15, 4) As Integer '磅?材料序 Setting.Config.SR
    Public SiloMatCount(15) As Integer '磅?材料數
    Public SiloMatName1(8) As String '磅?材料名稱1
    Public SiloMatName2(8) As String '磅?材料名稱2
    Public SiloMatType1(8) As String '磅?材料名稱1 99.07.28 S,G...
    Public SiloMatType2(8) As String '磅?材料名稱2
    Public SiloMatStatus1(15) As Boolean  'D30 骨材計料中 0~7
    Public SiloMatStatus2(15) As Boolean  'D31 泥料計料中 8~21 => 0~13 bit
    Public SiloMatDone1(15) As Boolean  'D33 骨材計料完成 0~7
    Public SiloMatDone2(15) As Boolean  'D34 泥料計料完成 8~21 => 0~13 bit

    '102.2.17
    Public NonAutoProd As Integer 'D34 bit15 on = 1 ,

    Public SiloMatOver1(15) As Boolean  'D38 骨材超量 0~7
    Public SiloMatOver2(15) As Boolean  'D39 泥料超量 8~21 => 0~13 bit
    Public SiloMatUnder1(15) As Boolean  'D38 骨材不足 0~7
    Public SiloMatUnder2(15) As Boolean  'D39 泥料不足 8~21 => 0~13 bit
    Public DgvLeft(15) As Integer       'DGVn left
    Public ZgcLeft1(8) As Integer       'zgc(bar) line1 left
    Public ZgcLeft2(8) As Integer       'zgc(bar) line2 left
    Public MatName(30) As String '材料名稱
    '105.5.23
    Public MatName_O(30) As String '材料名稱
    Public MatType(30) As String '材料種類 S,G,W,C,A
    Public SiloMatType(15) As String '材料種類 S,G,W,C,A
    '105.5.8
    Public iAE1_15_memo3 As Integer

    'Report
    Public startDateTime As DateTime 'print report for 1st pan
    Public stopDateTime As DateTime 'print report for lasst pan
    Public lineLen, matLen As Integer
    Public print1M3 As String     '列印參數 單方 Y / N
    Public printSP As String     '列印參數 調水後 Y / N
    Public printPV As String     '列印參數 計量值 Y / N
    Public printERR As String     '列印參數 計量值 Y / N
    Public printREMAIN As String     '列印參數 殘留值 Y / N
    Public printWATER As String     '列印參數 含水率 Y / N
    Public printREPORT As String     '列印參數 列印旗標 Y / N
    Public printTEMP As String     '列印reg
    '101.10.17
    Public printAdj As String     '列印參數 補正後 Y / N
    Public printWC As String     '列印參數 水灰比 Y / N
    Public printMix As String     '列印參數 辦合時間 Y / N
    '104.10.1
    Public printSA As String     '列印參數 S/A Y / N
    '110.9.14
    Public printTime As String     '列印參數 S/A Y / N
    '110.9.15 !!!
    'Public bCheckBoxYadon As String     'Yadon logo reg
    Public bCheckBoxYadon As Boolean     'Yadon logo reg
    '101.3.7
    Public bCheckBoxSingle As String     'Single monitor only for Yadon SuHai
    '100.3.20 for continue test
    Public bCheckBoxtTest As Boolean
    '102.5.11
    Public bCheckBoxCBC7 As String     '依土城CBC7報表格式 112.3.25 改成 列印拌合結束電流
    '112.3.25 列印拌合結束電流 from LabelCurrent3 when D22 change
    Public sLabelCurrent3 As String     '依土城CBC7報表格式 112.3.25 改成 列印拌合結束電流
    Public bUPDATEM3_1 As Boolean     'ORIG KG/M3 
    'Public bUPDATEM3_2 As Boolean     'REAL KG/M3 
    Public fSumorg As Single         'ORIG KG/M3
    Public fSumFrontA As Single         'ORIG KG/M3
    Public fSumFrontB As Single         'ORIG KG/M3
    Public fCubeLast As Single         'ORIG KG/M3

    '102.4.17 English version for Malaisia use orig 單螢幕
    Public bEngVer As Boolean
    '把常用的字定成 CONSTANT 102.8.13 verify
    '配比
    Public Const cRECIPE As String = "Formula"
    '方數
    Public Const cM3 As String = "Volume"
    '車號
    Public Const cCARNO As String = "Truck No."
    '核示單號
    Public Const cPO As String = "Site No."
    '工程名稱
    Public Const cSITE As String = "Site No."
    '施工部位
    Public Const cDESTINATION As String = "Struct. Port."
    '客戶名稱
    Public Const cCUSTOMER As String = "Customer"
    '動態調整
    Public Const cDYNAPARA As String = "Dynamic Adjustment"
    '歷史資料
    Public Const cHISTORY As String = "Historical Data"
    '參數設定
    Public Const cPARAMETER As String = "Parameters"
    '校磅
    Public Const cCALIBRATE As String = "Scale Calibration"
    '誤差百分比輸入
    Public Const cTOLERANCE As String = "Tolerance"
    '其他參數設定
    Public Const cOTHERS As String = "Other Setting"
    '區域補正設定
    Public Const cCORRECT As String = "Correction"
    '列印報表參數
    Public Const cPRINTREPORT As String = "Print Production Report"
    '新增/刪除 使用者
    Public Const cCHANGUSER As String = "USER MANAGER"
    '變更密碼
    Public Const cCHANGPASSWORD As String = "Change Password"
    '超量
    Public Const cOVER As String = "Over"
    '不足
    Public Const cUNDER As String = "Under"
    '計量中
    Public Const cWEIGHTING As String = "Weighing"
    '完成
    Public Const cDONE As String = "Complete"

    '102.5.11 cbc7 REPORT STYLE
    Public repFont = New Font("細明體", 12)

    '102.5.28 洗車不記入資料庫
    Public bWashCar As Boolean

    '102.7.15 B配比米數縮減
    Public bCheckBoxBPBsub As Boolean  ''enable flag by formula
    Public fBPBsub As Single          '配比米數縮減
    Public bCheckBoxBPBsuben As Boolean 'enable flag
    '102.7.15 B配比米數縮減
    Public bCheckBoxMsub As Boolean  ''enable flag by formula
    Public fMsub As Single          '配比米數縮減
    Public bCheckBoxMsuben As Boolean 'enable flag

    '104.8.10 not enough for scale2 
    'Public DV(1000) As Integer
    'Public DVold(100) As Integer    'for check if change of status
    'Public DVW(1000) As Integer
    Public DV(1200) As Integer
    '112.3.20 Public DVW(1200) As Integer
    Public DVW(4200) As Integer
    Public DVold(100) As Integer    'for check if change of status
    '110.7.7
    Public DVW_C16(6) As Integer
    '100.7.2
    'Public DVf(100) As Single    'weight for AE
    Public DVf(200) As Single    '100.7.2 D161~183 remain *.*
    Public DV22 As Integer
    Public DV38_U As Integer  'D38不足中 D38 bit 15=0
    Public DV38_O As Integer  'D38超量中 D38 bit 15=1
    Public DV39_U As Integer  'D39不足中 D38 bit 15=0
    Public DV39_O As Integer  'D39超量中 D38 bit 15=1
    'Public DVx(1000) As Integer

    'Public AlarmType(105) As Boolean  'Alarm type D16-00 ~ D19-15 true=alarm  false=warning
    '113.8.26
    '   add fuse alarm
    '   D341-D356   保險絲燒毀bit(每個D 16bit) 由D33-12決定掃瞄
    ' Alarm D16~19, D29,37,40 15*7=105  ==> 16*(7+16+1)=384 
    'Public AlarmName(105) As String 'Alarm description D16-00 ~ D19-15
    'Public AlarmDesc(105) As String 'Alarm description D16-00 ~ D19-15
    'Public AlarmType(105) As Integer  'Alarm type 1:Green, 2:Cyan, 3:Yellow, 4:lightRed
    'Public AlarmValue(105) As Boolean  'Alarm type D16-00 ~ D19-15 true=alarm  false=none
    'Public AlarmTime(105) As DateTime  'Alarm type D16-00 ~ D19-15 true=alarm  false=none
    'Public AlarmDV(7) As Integer    'Alarm DV D16~19 29 37 40 AlarmDV(7) for PC:COM..
    'Public AlarmDVOld(7) As Integer    'Alarm DV D16~19
    Public AlarmDvMax As Integer = 23    'orig AlarmDV(7)
    Public AlarmDvBitsMax As Integer = (AlarmDvMax + 1) * 16
    Public AlarmName(AlarmDvBitsMax) As String 'Alarm description D16-00 ~ D19-15
    Public AlarmDesc(AlarmDvBitsMax) As String 'Alarm description D16-00 ~ D19-15
    Public AlarmType(AlarmDvBitsMax) As Integer  'Alarm type 1:Green, 2:Cyan, 3:Yellow, 4:lightRed
    Public AlarmValue(AlarmDvBitsMax) As Boolean  'Alarm type D16-00 ~ D19-15 true=alarm  false=none
    Public AlarmTime(AlarmDvBitsMax) As DateTime  'Alarm type D16-00 ~ D19-15 true=alarm  false=none
    Public AlarmDV(AlarmDvMax) As Integer    'Alarm DV D16~19 29 37 40 AlarmDV(7) for PC:COM..
    Public AlarmDVOld(AlarmDvMax) As Integer    'Alarm DV D16~19

    Public strOther(30) As String   '其他參數
    Public fMaxM3 As Single         '最大拌合米數
    Public fMinM3 As Single         '最小拌合米數
    Public iMaxCurrent As Integer   '"最大電流"
    Public iMinCurrent As Integer   '"最小電流"
    Public iMaxMixTime As Integer   '最長拌合時間
    Public iMortarMin As Integer      '砂漿重量低限
    Public iMortarMax As Integer      '砂漿重量高限
    Public iNormalMin As Integer      '普通料重量低限
    Public iNormalMax As Integer      '普通料重量高限
    Public iQue1AlmDelay As Integer      '101.12.17 排隊一警示時間
    Public iQue1AlmEnable As Integer      '101.12.17 排隊一警示Enable
    Public fMaxM3_Mo As Single         '102.1.22 砂漿最大拌合米數
    Public iUniSer As Integer            '101.4.15 原已改 UNI_ => 本月車序 READ FROM MDN instead of registery 
    '=0 when new mdb else read max(UniCar) of mdb
    Public iCarSer As Integer            '本日車序
    Public iCarSer_SIM As Integer            '本日車序 for Simmulation
    Public sSavingDate As String      '
    Public ssSavingDate As String      '
    Public sSavingYear As String      'for open .mdb file
    Public dtSim As DateTime  ' for Sim print DateTime
    Public dtSimP(11) As DateTime  ' for Sim print DateTime
    Public dtBatDon As DateTime  ' 101.12.17 for Batch done
    Public dtBatDonInt As Integer  ' 101.12.17 for Batch done
    Public dtBatDonQ1 As DateTime  ' 102.2.17 for Batch done
    Public dtBatDonIntQ1 As Integer  ' 1012.2.17 for Batch done

    '系統設定
    Public bWaitTank As Boolean     '待拌槽 true=yes  false=none
    Public bABPB As Boolean         'ＡＢ配比 true=yes  false=none
    'Public sCarMaxM3 As String          '最大拌合米數
    Public fCarMaxM3 As Single          '最大拌合米數
    Public sCompany As String           '公司名稱
    Public sMixerNo As String           '拌合機# for print
    Public fScaleZeroMax As Single           '校磅歸零最大值
    Public fScaleSpanMax As Single           '校磅校準最大值
    Public fScaleSpanMin As Single           '校磅校準最小值
    Public sDataBaseIP As String        '調度資料伺服器IP
    Public bDataBaseLink As Boolean     '調度資料伺服器IP OK
    Public sProject As String           '專案名稱
    Public sYMdbName As String       'path : \JS\DATA_Q01\Y2010.mdb
    '105.7.5
    Public sYMdbName_A As String       'path Z:\A\DATA_Q01\Y2010.mdb for formul REMOTE A
    '105.6.26
    Public sYMdbName_B As String       'path Z:\B\DATA_Q01\Y2010.mdb for formul REMOTE B
    '105.7.14
    Public sYMdbName_B_Local As String       'path for local temp B C:\Program Files\B\DATA_Q01\Y2010.mdb for formul REMOTE B
    Public sSMdbName As String       'path : \JS\CONF_Q01\SETTING.mdb 

    '101.12.12
    Public sTextBoxSP1 As String           '備用一
    Public sTextBoxSP2 As String           '備用一
    Public sTextBoxSP3 As String           '備用一
    Public sTextBoxSP4 As String           '備用一


    '最大拌合方數
    '
    Public sPlcCom As String
    '105.7.5
    Public sPlcDelay As String  '烏日 300 100
    Public iCurrentTime As Integer  '電流表 X
    Public iCurrent As Integer      '電流表 X
    Public iCurrentTimeOld As Integer  '電流表 old X
    Public iCurrentOld As Integer      '電流表 old X

    ' Color constant for show
    Public colorSand1 As Color
    Public colorSand2 As Color
    Public colorStone1 As Color
    Public colorStone2 As Color
    Public colorWater1 As Color
    Public colorWater2 As Color
    Public colorCement1 As Color
    Public colorCement2 As Color
    Public colorDrog1 As Color
    Public colorDrog2 As Color

    Public ErrFlag As Integer   ' =0 none, =1 show PV-SV , false Err% 

    Public bCommFlag As Boolean         'true:have COM false no COM
    Public BoneDoneChanging As Boolean  'for read D61, after read D61 reset
    Public ModDoneChanging As Boolean   'for read D70, after read D70 reset
    Public ModDoneChangingD70 As Boolean   'for read D70, after read D70 reset
    Public str_cur_weight(2) As Single '每盤完成後實際重量 A (0):report, (1):real

    'ｆｏｒ　ｕｓｅｒ
    Public UserName As String
    Public UserLevel As String

    '100.4.18 for thread
    Public s_start_day As String
    Public s_datafile As String

    '100.6.29
    Public bCheckBoxS As Boolean     '砂小數 true=*.*  false=*
    Public bCheckBoxG As Boolean     '砂小數 true=*.*  false=*
    Public bCheckBoxW As Boolean     '砂小數 true=*.*  false=*
    Public bCheckBoxC As Boolean     '砂小數 true=*.*  false=*
    '110.6.5 亞東 水泥確認
    '110.6.5 水泥確認 CHECK C1-C6
    Public sCementPer As String           '備用一
    '110.6.17   台泥 藥劑區域
    Public bCheckBoxAE As Boolean = True    '110.9.11 
    '104.9.24 FOR FORMULA CHECK C1-C6
    Public bCheckBoxC1 As Boolean
    Public bCheckBoxC2 As Boolean
    Public bCheckBoxC3 As Boolean
    Public bCheckBoxC4 As Boolean
    Public bCheckBoxC5 As Boolean
    Public bCheckBoxC6 As Boolean
    '110.1.28
    Public bCheckBoxDelPB As Boolean
    '101.4.5
    Public bCheckBoxS4 As Boolean     '砂4小數 true=*.*  false=*
    '102.1.22
    Public bCheckBoxtTot2dec As Boolean     'total 小數2位 true=*.**  false=*  for 台電
    '102.3.16
    Public bCheckBoxMix As Boolean     'total 小數2位 true=*.**  false=*  for 台電
    '103.6.7
    Public bCheckBoxNonAuto As Boolean     '非自動上傳
    '104.5.2 104.9.4
    Public bCheckBoxRemain As Boolean     '列印參數 殘留 顯示旗標
    Public bCheckBoxSP1 As Boolean     'spare 1 for future use 105.5.4 Singapore A1-1 ~ A1-15
    Public bCheckBoxSP2 As Boolean     'spare 2 
    Public bCheckBoxSP3 As Boolean     'spare 3 105.6.26 B FORMULA SAVE FLAG

    '100.12.20 remain change    101.3.21 => D20 change 
    Public ReadD61Flag As Integer 'D20 change =>1, Receive D61 =>2, update D20=>0
    '101.3.21
    Public ReadD70Flag As Integer 'D21 change =>1, D70	W1修正印出值
    Public ReadD161Flag As Integer 'D22 change =>1, D161	S1殘留值
    '101.4.2 for FontSize
    Dim MatCount As Integer
    '101.4.8 for S4 *.*
    Public S4SiloNo As Integer

    '102.11.23 102.11.25
    Public strCementName(10) As String   '水泥0-5,AE:6-10註記 102.11.25
    Public strCement(10) As String   '水泥註記
    Public strCementEnable(10) As String   '水泥註記 0:disable
    Public bCheckBoxCement As Boolean 'enable flag
    '102.12.11
    Public bCheckBoxBack As Boolean '廠別切換 enable flag
    '103.3.11
    Public bCheckBoxImperial As Boolean '英制切換 enable flag
    '102.12.18
    Public bImperial As Boolean '英制切換 enable flag
    Public fImperial As Single = 1.0 '英制切換 enable flag
    Public Const KG_TO_LB As Single = 2.2046
    '103.3.11
    Public Const LB_TO_KG As Single = 0.4536
    Public Const Y3_TO_M3 As Single = 0.7645
    Public fY3_TO_M3 As Single = 1.0 '英制切換 enable flag
    Public fLB_TO_KG As Single = 1.0 '英制切換 enable flag
    Public sUNIT As String = "kg" '英制切換 enable flag

    '104.8.8 for stand defaultWater
    '104.12.24
    'Public TrendGood(200) As Single    'current
    Public TrendGood(300) As Single    'current
    Public strWatPb(20) As String   ' 預設含水率 PB  15?
    Public strWatField(20) As String   ' 預設含水率 field
    '111.11.6 指定列印 CheckBoxSP19 bCheckBoXSP19 核示單號
    Public strWatPrint(20) As String   ' 預設含水率 field
    Public fWat(8, 20) As Single    '預設含水率 20組 read from water2.per
    Public fWatOrig(15) As Single    '原含水率
    Public bDefaultWatEn As Boolean     '符合預設含水率配比strWatPbstr & 工地WatField(15)
    Public bDefaultWatEn_Last As Boolean
    '104.8.18 for index of fWat
    Public iDefaultWatInd As Integer
    '104.8.10 send scale 1~0
    Public SiloMatName(15) As String '磅?材料名稱 (15):待拌槽 '104.8.15
    '104.8.20 for simmulate DV(23) time DV(25) current
    Public iSimTime As Integer
    '104.12.24 more 
    'Public iTrendSave(200) As Integer    'current to save
    Public iTrendSave(300) As Integer    'current to save
    Public iDV23_Old As Integer
    '104.9.24
    Public iDV23_Old_2 As Integer
    '104.9.26
    Public iDV25_Old As Integer
    Public iDV25_Old_2 As Integer
    Public strTrendPb As String   ' History Trend PB
    Public strTrendM3 As String   ' History Trend M3
    Public iTrendHighOffset As Integer '"標準電流圖 高限位移"
    Public iTrendLowOffset As Integer '"標準電流圖 低限位移"
    Public iTrendDrawFlag As Integer '"標準電流圖 低限位移"
    '104.8.27 DV(36) bit 1 自動中 for 連線中 不可切換回
    Public bAuto As Boolean
    Public EndCurrent As Single
    '104.9.24 c1-c6配比檢查低限(for next Pan in fact )
    Public iC1_C6_LowLimit As Integer
    '104.9.28
    Public strChangedPb As String   ' History Trend PB
    '104.10.1 S1~G4 比重
    Public SG_Grav(8) As Single

    '15.5.12
    Public strAE15Name(15) As String   'AE1-1~15

    Public Const M3_TO_FT3 As Single = 35.3
    Public Const M3KG_TO_YR3LB As Single = 1.69

    '107.5.21
    Public iTextBoxX As Integer
    Public iTextBoxY As Integer
    Public iTextBoxX2 As Integer
    Public iTextBoxY2 As Integer

    '107.8.20
    '   聯佶 W1 不參與水分補正
    Public bCheckBoxW1 As Boolean
    Public bCheckBoxW2 As Boolean
    Public bCheckBoxW3 As Boolean


    Public Sub ReadOther()
        '105.7.16
        LoginForm1.Refresh()

        '107.5.21
        iTextBoxX = CInt(GetSetting("JS", "CBC800", "iTextBoxX", "1280"))
        iTextBoxY = CInt(GetSetting("JS", "CBC800", "iTextBoxY", "960"))
        iTextBoxX2 = CInt(GetSetting("JS", "CBC800", "iTextBoxX2", "1280"))
        iTextBoxY2 = CInt(GetSetting("JS", "CBC800", "iTextBoxY2", "960"))
        MainForm.Width = iTextBoxX
        MainForm.Height = iTextBoxY
        MainForm.Refresh()
        FrmMonit.Width = iTextBoxX2
        FrmMonit.Height = iTextBoxY2
        FrmMonit.Refresh()


        '111.7.22
        '   模擬報表 首盤 CheckBoxFirstPan
        bCheckBoxFirstPan = CBool(GetSetting("JS", "CBC800", "bCheckBoxFirstPan", "false"))

        '105.9.3
        bCheckBoxsSim = CBool(GetSetting("JS", "CBC800", "bCheckBoxsSim", "false"))
        MainForm.CheckBoxsSim.Checked = bCheckBoxsSim

        fMaxM3 = CSng(GetSetting("JS", "CBC800", "MaxM3", "3.00"))
        fMaxM3_Mo = CSng(GetSetting("JS", "CBC800", "MaxM3_mo", "3.00"))
        '102.1.22
        fMinM3 = CSng(GetSetting("JS", "CBC800", "MinM3", "0.5"))
        iMaxCurrent = CInt(GetSetting("JS", "CBC800", "MaxCurrent", "500"))
        iMinCurrent = CInt(GetSetting("JS", "CBC800", "MinCurrent", "200"))
        iMortarMin = CInt(GetSetting("JS", "CBC800", "iMortarMin", "1000"))
        iMortarMax = CInt(GetSetting("JS", "CBC800", "iMortarMax", "2400"))
        iNormalMin = CInt(GetSetting("JS", "CBC800", "iNormalMin", "2000"))
        iNormalMax = CInt(GetSetting("JS", "CBC800", "iNormalMax", "2500"))
        '101.12.17
        iQue1AlmDelay = CInt(GetSetting("JS", "CBC800", "iQue1AlmDelay", "60"))
        iQue1AlmEnable = CInt(GetSetting("JS", "CBC800", "iQue1AlmEnable", "0"))
        '101.4.14 
        'iUniSer = CInt(GetSetting("JS", "CBC800", "iUniSer", "1"))
        iUniSer = CInt(GetSetting("JS", "CBC800", "iUniSer", "0"))
        iCarSer = CInt(GetSetting("JS", "CBC800", "iCarSer", "0"))
        iCarSer_SIM = CInt(GetSetting("JS", "CBC800", "iCarSer_SIM", "0"))
        sSavingDate = GetSetting("JS", "CBC800", "sSavingDate", "2010/4/30")
        '102.7.15
        'bCheckBoxBPBsub = CBool(GetSetting("JS", "CBC800", "bCheckBoxBPBsub", "false"))
        '107.10.22 no save just 0 everytime
        'fBPBsub = CSng(GetSetting("JS", "CBC800", "fBPBsub", "0.00"))
        fBPBsub = 0.0

        sSavingYear = GetSetting("JS", "CBC800", "sSavingYear", "2010")

        print1M3 = CBool(GetSetting("JS", "CBC800", "print1M3", "false"))
        printSP = CBool(GetSetting("JS", "CBC800", "printSP", "false"))
        printPV = CBool(GetSetting("JS", "CBC800", "printPV", "false"))
        printERR = CBool(GetSetting("JS", "CBC800", "printERR", "false"))
        printREMAIN = CBool(GetSetting("JS", "CBC800", "printREMAIN", "false"))
        printWATER = CBool(GetSetting("JS", "CBC800", "printWATER", "false"))
        printREPORT = CBool(GetSetting("JS", "CBC800", "printREPORT", "false"))
        '101.10.17
        printAdj = CBool(GetSetting("JS", "CBC800", "printAdj", "false"))
        printWC = CBool(GetSetting("JS", "CBC800", "printWC", "false"))
        printMix = CBool(GetSetting("JS", "CBC800", "printMix", "false"))
        '104.10.1
        printSA = CBool(GetSetting("JS", "CBC800", "printSA", "false"))
        '110.9.14
        printTime = CBool(GetSetting("JS", "CBC800", "printTime", "false"))

        '100.6.29
        bCheckBoxS = CBool(GetSetting("JS", "CBC800", "bCheckBoxS", "false"))
        bCheckBoxG = CBool(GetSetting("JS", "CBC800", "bCheckBoxG", "false"))
        bCheckBoxW = CBool(GetSetting("JS", "CBC800", "bCheckBoxW", "false"))
        bCheckBoxC = CBool(GetSetting("JS", "CBC800", "bCheckBoxC", "false"))
        '107.8.20
        '   聯佶 W1 不參與水分補正
        bCheckBoxW1 = CBool(GetSetting("JS", "CBC800", "bCheckBoxW1", "false"))
        bCheckBoxW2 = CBool(GetSetting("JS", "CBC800", "bCheckBoxW2", "false"))
        bCheckBoxW3 = CBool(GetSetting("JS", "CBC800", "bCheckBoxW3", "false"))
        '110.6.5 亞東 水泥確認
        sCementPer = GetSetting("JS", "CBC800", "sCementPer", "85")
        '110.6.17   台泥 藥劑區域 110.9.11 by alwayse true
        'bCheckBoxAE = CBool(GetSetting("JS", "CBC800", "bCheckBoxAE", "false"))

        '110.9.14 from ReadCemWarehouse()
        'bCheckBoxC1 = CBool(GetSetting("JS", "CBC800", "bCheckBoxC1", "false"))
        'bCheckBoxC2 = CBool(GetSetting("JS", "CBC800", "bCheckBoxC2", "false"))
        'bCheckBoxC3 = CBool(GetSetting("JS", "CBC800", "bCheckBoxC3", "false"))
        'bCheckBoxC4 = CBool(GetSetting("JS", "CBC800", "bCheckBoxC4", "false"))
        'bCheckBoxC5 = CBool(GetSetting("JS", "CBC800", "bCheckBoxC5", "false"))
        'bCheckBoxC6 = CBool(GetSetting("JS", "CBC800", "bCheckBoxC6", "false"))
        Call frmOther.ReadCemWarehouse()
        '110.10.5
        'If bCheckBoxYadon Then
        '    Call frmOther.ReadCemWarehouse()
        'Else
        'End If

        '101.4.5
        bCheckBoxS4 = CBool(GetSetting("JS", "CBC800", "bCheckBoxS4", "false"))

        '104.8.20
        iTrendHighOffset = CInt(GetSetting("JS", "CBC800", "iTrendHighOffset", "10"))
        iTrendLowOffset = CInt(GetSetting("JS", "CBC800", "iTrendLowOffset", "10"))
        '104.9.24
        iC1_C6_LowLimit = CInt(GetSetting("JS", "CBC800", "iC1_C6_LowLimit", "100"))
        '104.10.1
        SG_Grav(0) = CSng(GetSetting("JS", "CBC800", "SG_Grav_S1", "2.40"))
        SG_Grav(1) = CSng(GetSetting("JS", "CBC800", "SG_Grav_S2", "2.40"))
        SG_Grav(2) = CSng(GetSetting("JS", "CBC800", "SG_Grav_S3", "2.40"))
        SG_Grav(3) = CSng(GetSetting("JS", "CBC800", "SG_Grav_S4", "2.40"))
        SG_Grav(4) = CSng(GetSetting("JS", "CBC800", "SG_Grav_G1", "2.40"))
        SG_Grav(5) = CSng(GetSetting("JS", "CBC800", "SG_Grav_G2", "2.40"))
        SG_Grav(6) = CSng(GetSetting("JS", "CBC800", "SG_Grav_G3", "2.40"))
        SG_Grav(7) = CSng(GetSetting("JS", "CBC800", "SG_Grav_G4", "2.40"))

        '106.11.22 ref 土城 bug
        '105.11.15
        fMaxWaterPer = CSng(GetSetting("JS", "CBC800", "MaxWaterPer", "20.0"))
        '105.12.27.
        fMinWaterPer = CSng(GetSetting("JS", "CBC800", "MinWaterPer", "0.0"))

        '105.6.26 B存放磁碟(C:,Z:)
        '105.8.14
        'sTextBoxBpath = GetSetting("JS", "CBC800", "sTextBoxBpath", "C:\")
        '105.6.30 遠端A存放磁碟
        sTextBoxSPARE1 = GetSetting("JS", "CBC800", "sTextBoxSPARE1", "C:\")
        sTextBoxSPARE2 = GetSetting("JS", "CBC800", "sTextBoxSPARE2", "SPARE2")
        sTextBoxSPARE3 = GetSetting("JS", "CBC800", "sTextBoxSPARE3", "SPARE3")
        sTextBoxSPARE4 = GetSetting("JS", "CBC800", "sTextBoxSPARE4", "SPARE4")
        sTextBoxSPARE5 = GetSetting("JS", "CBC800", "sTextBoxSPARE5", "SPARE5")

        '110.9.14 bCheckBoxSP1~20 MUST FROM ReadAdmin()
        'bCheckBoxSP1 = CBool(GetSetting("JS", "CBC800", "bCheckBoxSP1", "false"))
        'bCheckBoxSP2 = CBool(GetSetting("JS", "CBC800", "bCheckBoxSP2", "false"))
        'bCheckBoxSP3 = CBool(GetSetting("JS", "CBC800", "bCheckBoxSP3", "false"))
        'bCheckBoxSP4 = CBool(GetSetting("JS", "CBC800", "bCheckBoxSP4", "false"))
        'bCheckBoxSP5 = CBool(GetSetting("JS", "CBC800", "bCheckBoxSP5", "false"))
        'bCheckBoxSP6 = CBool(GetSetting("JS", "CBC800", "bCheckBoxSP6", "false"))
        'bCheckBoxSP7 = CBool(GetSetting("JS", "CBC800", "bCheckBoxSP7", "false"))
        'bCheckBoxSP8 = CBool(GetSetting("JS", "CBC800", "bCheckBoxSP8", "false"))
        'bCheckBoxSP9 = CBool(GetSetting("JS", "CBC800", "bCheckBoxSP9", "false"))
        ''105.10.7
        'bCheckBoxSP10 = CBool(GetSetting("JS", "CBC800", "bCheckBoxSP10", "false"))
        'bCheckBoxSP11 = CBool(GetSetting("JS", "CBC800", "bCheckBoxSP11", "false"))
        'bCheckBoxSP12 = CBool(GetSetting("JS", "CBC800", "bCheckBoxSP12", "false"))
        'bCheckBoxSP13 = CBool(GetSetting("JS", "CBC800", "bCheckBoxSP13", "false"))
        'bCheckBoxSP14 = CBool(GetSetting("JS", "CBC800", "bCheckBoxSP14", "false"))
        'bCheckBoxSP15 = CBool(GetSetting("JS", "CBC800", "bCheckBoxSP15", "false"))
        ''110.1.28
        'bCheckBoxDelPB = CBool(GetSetting("JS", "CBC800", "bCheckBoxDelPB", "false"))
        ''107.6.10
        'bCheckBoxSP16 = CBool(GetSetting("JS", "CBC800", "bCheckBoxSP16", "false"))
        'bCheckBoxSP17 = CBool(GetSetting("JS", "CBC800", "bCheckBoxSP17", "false"))
        'bCheckBoxSP18 = CBool(GetSetting("JS", "CBC800", "bCheckBoxSP18", "false"))
        'bCheckBoxSP19 = CBool(GetSetting("JS", "CBC800", "bCheckBoxSP19", "false"))
        'bCheckBoxSP20 = CBool(GetSetting("JS", "CBC800", "bCheckBoxSP20", "false"))

        '107.1.31
        sPlcCom2 = (GetSetting("JS", "CBC800", "PlcCom2", "COM1"))
        bCheckBox232 = CBool(GetSetting("JS", "CBC800", "CheckBox232", "false"))
        bCheckBoxA = CBool(GetSetting("JS", "CBC800", "CheckBoxA", "false"))
        PLC_232_2.BaudRate = 9600
        PLC_232_2.DataBit = 7
        PLC_232_2.StopBit = Rs232.DataStopBit.StopBit_1
        PLC_232_2.Parity = Rs232.DataParity.Parity_Even
        PLC_232_2.Rts = True
        PLC_232_2.Dtr = True
        PLC_232_2.Port = CInt(Microsoft.VisualBasic.Strings.Right(sPlcCom2, 1))
        PLC_232_2.BufferSize = 1024
        If bCheckBox232 Then PLC_232_2.Open()

        '105.7.19
        'If bRadioButton_NO2 Then
        '    sProject = sTextBoxPrj2
        'Else
        '    sProject = sTextBoxPrj
        'End If

        '105.7.21 105.8.3
        MainForm.Label2.Text = sCompany

        'CarSer
        Dim s As String
        '100.4.18
        's = Today.ToShortDateString
        s = "#" & Format(Now, "yyyy/MM/dd ") & "#"
        If s = sSavingDate Then
            '100.6.11 iCarSer from 1~ for day => d001 ~ for unique in .mdb
            '106.5.27 no use
            'If iCarSer < 1000 Then iCarSer += Now.Day * 1000
            If iCarSer_SIM < 1000 Then iCarSer_SIM += Now.Day * 1000
        Else
            '106.5.27 no use
            ' iCarSer = Now.Day * 1000
            sSavingDate = s
            SaveSetting("JS", "CBC800", "sSavingDate", s)
            SaveSetting("JS", "CBC800", "iCarSer", "0")
            'iCarSer_SIM = 0
            iCarSer_SIM = Now.Day * 1000
            SaveSetting("JS", "CBC800", "iCarSer_SIM", "0")
        End If
        'ssSavingDate = Microsoft.VisualBasic.Left(Microsoft.VisualBasic.Right(sSavingDate, 12), 10)

        '104.11.2 11.8
        ssSavingDate = CDate(sSavingDate).ToShortDateString
        s = Today.Year.ToString & "M" & Today.Month.ToString
        '101.4.15
        Dim NewMdb As Boolean
        If s = sSavingYear Then
            '101.4.15
            NewMdb = False
        Else
            sSavingYear = s
            SaveSetting("JS", "CBC800", "sSavingYear", sSavingYear)
            '101.4.14 
            'iUniSer = 1
            iUniSer = 0
            '101.4.15 SaveSetting("JS", "CBC800", "iUniSer", "1")
            NewMdb = True
        End If

        '111.4.4
        '   CheckDrog6() : check if C:\JS\OrigFile\New_datasample.mdb have Drog6
        '111.6.24 CheckDrog6()

        Dim file
        file = My.Computer.FileSystem.DirectoryExists("\JS\CBC8\DATA_" & sProject)
        If file = False Then My.Computer.FileSystem.CreateDirectory("\JS\CBC8\DATA_" & sProject)
        If Not My.Computer.FileSystem.FileExists(sYMdbName + sSavingYear + ".mdb") Then
            My.Computer.FileSystem.CopyFile("\JS\OrigFile\New_datasample_f.mdb", sYMdbName + sSavingYear + ".mdb")
        End If

        '105.7.14
        '113.8.13
        'file = My.Computer.FileSystem.DirectoryExists("\Program Files\JS\CBC8\DATA_" & sProject)
        'If file = False Then My.Computer.FileSystem.CreateDirectory("\Program Files\JS\CBC8\DATA_" & sProject)
        file = My.Computer.FileSystem.DirectoryExists("\JS\QJ\JS\CBC8\DATA_" & sProject)
        If file = False Then My.Computer.FileSystem.CreateDirectory("\Log\JS\CBC8\DATA_" & sProject)
        If Not My.Computer.FileSystem.FileExists(sYMdbName_B_Local + sSavingYear + ".mdb") Then
            My.Computer.FileSystem.CopyFile("\JS\OrigFile\New_datasample_f.mdb", sYMdbName_B_Local + sSavingYear + ".mdb")
            '110.1.1 for 配比15碼 
            My.Computer.FileSystem.CopyFile("\JS\OrigFile\New_datasample_f.mdb", sYMdbName_B_Local + sSavingYear + "A.mdb")
        End If

        '110.10.5 bug
        'file = My.Computer.FileSystem.DirectoryExists("\JS\OrigFile\CONF_" & sProject)
        'If file = False Then My.Computer.FileSystem.CreateDirectory("\JS\OrigFile\CONF_" & sProject)
        file = My.Computer.FileSystem.DirectoryExists("\JS\CBC8\CONF_" & sProject)
        If file = False Then My.Computer.FileSystem.CreateDirectory("\JS\CBC8\CONF_" & sProject)
        If Not My.Computer.FileSystem.FileExists(sSMdbName & "\setting.mdb") Then
            My.Computer.FileSystem.CopyFile("\JS\OrigFile\setting_org.mdb", sSMdbName & "\setting.mdb")
        End If
        '100.4.4
        If Not My.Computer.FileSystem.FileExists(sSMdbName & "\Recipe.mdb") Then
            My.Computer.FileSystem.CopyFile("\JS\OrigFile\RecipeOrig.mdb", sSMdbName & "\Recipe.mdb")
        End If

        '110.10.5 bug
        'file = My.Computer.FileSystem.DirectoryExists("\JS\OrigFile\CONF_" & sProject)
        'If file = False Then My.Computer.FileSystem.CreateDirectory("\JS\OrigFile\CONF_" & sProject)
        'If Not My.Computer.FileSystem.FileExists(sSMdbName & "\setting.mdb") Then
        '    My.Computer.FileSystem.CopyFile("\JS\OrigFile\setting_org.mdb", sSMdbName & "\setting.mdb")
        'End If
        '100.4.4
        If Not My.Computer.FileSystem.FileExists(sSMdbName & "\Recipe.mdb") Then
            My.Computer.FileSystem.CopyFile("\JS\OrigFile\RecipeOrig.mdb", sSMdbName & "\Recipe.mdb")
        End If

        '110.6.17   台泥 藥劑區域
        If bCheckBoxAE Then
            Dim db_setting As New DbAccess(sSMdbName & "\setting.mdb")
            Dim dt_setting = db_setting.GetDataTable("select * from correctarea")
            Dim cnt
            cnt = dt_setting.Columns.Count  'orig 6 : Area,Sand,stone,water,concrete,sandstone
            '110.9.11
            Dim sql1 As String
            If cnt < 7 Then
                sql1 = "ALTER TABLE correctarea ADD [AE] int not NULL "
                db_setting.ExecuteCmd(sql1)
                '110.7.8
                dt_setting = db_setting.GetDataTable("select [AE] from correctarea")
                sql1 = "UPDATE correctarea SET [AE]=0 "
                db_setting.ExecuteCmd(sql1)
            End If
            dt_setting = db_setting.GetDataTable("select * from CorrectItem")
            cnt = dt_setting.Columns.Count  'orig 20 : 
            If cnt < 21 Then
                sql1 = "ALTER TABLE CorrectItem ADD [Drog1] int not NULL "
                db_setting.ExecuteCmd(sql1)
                sql1 = "ALTER TABLE CorrectItem ADD [Drog2] int not NULL "
                db_setting.ExecuteCmd(sql1)
                sql1 = "ALTER TABLE CorrectItem ADD [Drog3] int not NULL "
                db_setting.ExecuteCmd(sql1)
                sql1 = "ALTER TABLE CorrectItem ADD [Drog4] int not NULL "
                db_setting.ExecuteCmd(sql1)
                sql1 = "ALTER TABLE CorrectItem ADD [Drog5] int not NULL "
                db_setting.ExecuteCmd(sql1)
                '110.10.5
                dt_setting = db_setting.GetDataTable("select [Drog1],[Drog2],[Drog3],[Drog4],[Drog5] from CorrectItem")
                sql1 = "UPDATE CorrectItem SET [Drog1]=0,[Drog2]=0,[Drog3]=0,[Drog4]=0,[Drog5]=0 "
                db_setting.ExecuteCmd(sql1)
                '110.9.11 110.10.5
                'dt_setting = db_setting.GetDataTable("select [Drog1] from correctarea")
                'sql1 = "UPDATE CorrectItem SET [Drog1]=0 "
                'dt_setting = db_setting.GetDataTable("select [Drog2] from correctarea")
                'sql1 = "UPDATE CorrectItem SET [Drog2]=0 "
                'dt_setting = db_setting.GetDataTable("select [Drog3] from correctarea")
                'sql1 = "UPDATE CorrectItem SET [Drog3]=0 "
                'dt_setting = db_setting.GetDataTable("select [Drog4] from correctarea")
                'sql1 = "UPDATE CorrectItem SET [Drog4]=0 "
                'db_setting.ExecuteCmd(sql1)
                'dt_setting = db_setting.GetDataTable("select [Drog5] from correctarea")
                'sql1 = "UPDATE CorrectItem SET [Drog5]=0 "
            End If
            db_setting.dispose()
        End If

        '
        '109.4.2 配比連線
        'If bPbSync Then '109.5.01 not only but all
        '連結資料庫
        Dim db_mdb As New DbAccess(sSMdbName & "\Recipe.mdb")
        '抓取編號為id的資料
        Dim dt_mdb As DataTable = db_mdb.GetDataTable("select ID,code from fomula order by ID asc")
        'Purge null code in mdb
        Dim sql As String
        Dim iRet, jj

        '109.12.79 配比15碼
        '           110.1.5
        If bCheckBoxSP17 And False Then
            Dim dbrec As New DbAccess(sYMdbName + sSavingYear + ".mdb")
            sql = "ALTER TABLE Recdata ALTER COLUMN Fomula VARCHAR(15)"
            dbrec.ExecuteCmd(sql)
            sql = "ALTER TABLE Recdata_B ALTER COLUMN Fomula VARCHAR(15)"
            dbrec.ExecuteCmd(sql)
            sql = "ALTER TABLE Recdata_SIM ALTER COLUMN Fomula VARCHAR(15)"
            dbrec.ExecuteCmd(sql)

            dbrec.changedb(sYMdbName_B_Local + sSavingYear + ".mdb")
            sql = "ALTER TABLE Recdata ALTER COLUMN Fomula VARCHAR(15)"
            dbrec.ExecuteCmd(sql)
            sql = "ALTER TABLE Recdata_B ALTER COLUMN Fomula VARCHAR(15)"
            dbrec.ExecuteCmd(sql)
            sql = "ALTER TABLE Recdata_SIM ALTER COLUMN Fomula VARCHAR(15)"
            dbrec.ExecuteCmd(sql)

            '110.1.1 bug maybe no file
            dbrec.changedb(sYMdbName_B_Local + sSavingYear + "A.mdb")
            sql = "ALTER TABLE Recdata ALTER COLUMN Fomula VARCHAR(15)"
            dbrec.ExecuteCmd(sql)
            sql = "ALTER TABLE Recdata_B ALTER COLUMN Fomula VARCHAR(15)"
            dbrec.ExecuteCmd(sql)
            sql = "ALTER TABLE Recdata_SIM ALTER COLUMN Fomula VARCHAR(15)"
            dbrec.ExecuteCmd(sql)
            '110.1.5
            dbrec.dispose()

            'Recipe.mdb
            sql = "ALTER TABLE Fomula ALTER COLUMN Code VARCHAR(15)"
            db_mdb.ExecuteCmd(sql)
            sql = "ALTER TABLE Fomula ALTER COLUMN Spare VARCHAR(15)"
            db_mdb.ExecuteCmd(sql)
            Dim db_scale As New DbAccess(sSMdbName & "\Scale.mdb")  '連結資料庫
            sql = "ALTER TABLE PBHistory ALTER COLUMN PB VARCHAR(15)"
            db_scale.ExecuteCmd(sql)
            db_scale.dispose()
        End If

        sql = "DELETE FROM Fomula WHERE code IS NULL "
        Try
            iRet = db_mdb.ExecuteCmd(sql)
        Catch ex As Exception
        End Try


        sql = "SELECT * FROM Fomula ORDER BY ID "
        dt_mdb = db_mdb.GetDataTable(sql)

        'fields to add or not
        jj = dt_mdb.Columns.Count
        If jj < 50 Then
            fommula_Mdb.AddYatongFields(db_mdb)
            fommula_Mdb.SetYatongFields(db_mdb)
        End If
        'End If

        '105.7.10
        If Not My.Computer.FileSystem.FileExists(sSMdbName & "\Scale.mdb") Then
            My.Computer.FileSystem.CopyFile("\JS\OrigFile\Scale_org.mdb", sSMdbName & "\Scale.mdb")
        End If



        '103.8.30
        '101.4.18
        Dim db As New DbAccess(sYMdbName + sSavingYear + ".mdb")
        Dim dt As DataTable = db.GetDataTable("select  max(UniID) from recdata ")
        '101.5.1
        Dim st
        st = dt.Rows(0).Item(0).ToString
        If st = "" Then
            iUniSer = 1
            iCarSer = 1
        Else
            iUniSer = CInt(dt.Rows(0).Item(0).ToString) + 1
            iCarSer = CInt(dt.Rows(0).Item(0).ToString) + 1
        End If

        '101.4.15
        MainForm.LabelUniCar.Text = iUniSer
        MainForm.LabelCarSer.Text = iCarSer

        'Dim i, j As Integer
        'Dim s As String = "0.0"
        'i = MainForm.DataGridView1.RowCount
        'Dim fileNum
        'fileNum = FreeFile()
        'FileOpen(fileNum, "\JS\Cbc8_Water.Per", OpenMode.Input)
        'If Not EOF(fileNum) Then
        '    For j = 0 To i - 1
        '        Input(fileNum, s)
        '        'Input(fileNum, MainForm.DataGridView1.Rows(j).Cells(0).Value)
        '        MainForm.DataGridView1.Rows(j).Cells(0).Value = s
        '    Next
        '    FileClose(fileNum)
        'End If

        '104.8.9 read defaultWater
        Dim fileNum
        Dim i, j
        fileNum = FreeFile()
        file = My.Computer.FileSystem.FileExists(sSMdbName & "\water2.per")
        If file = False Then
            For i = 1 To 160
                My.Computer.FileSystem.WriteAllText(sSMdbName & "\water2.per", "0.0" & vbCrLf, True, System.Text.Encoding.Default)
            Next
        End If

        FileOpen(fileNum, sSMdbName & "\water2.per", OpenMode.Input)
        If Not EOF(fileNum) Then
            For i = 0 To 14
                For j = 0 To 7
                    s = LineInput(fileNum)
                    fWat(j, i) = Val(s)
                    'DataGridViewWat.Rows(i).Cells(j + 3).Value = s
                Next
            Next
        End If
        FileClose(fileNum)

        '105.6.25
        fileNum = FreeFile()
        file = My.Computer.FileSystem.FileExists(sSMdbName & "\water3.per")
        If file = False Then
            For i = 1 To 30
                My.Computer.FileSystem.WriteAllText(sSMdbName & "\water3.per", "." & vbCrLf, True, System.Text.Encoding.Default)
            Next
        End If
        FileOpen(fileNum, sSMdbName & "\water3.per", OpenMode.Input)
        If Not EOF(fileNum) Then
            For i = 0 To 14
                strWatPb(i) = LineInput(fileNum)
                strWatField(i) = LineInput(fileNum)
            Next
        End If
        FileClose(fileNum)

        '111.11.6 指定列印 CheckBoxSP19 bCheckBoXSP19 核示單號 => print report only enabled
        If bCheckBoxSP19 Then
            fileNum = FreeFile()
            file = My.Computer.FileSystem.FileExists(sSMdbName & "\water4.per")
            If file = False Then
                For i = 1 To 15
                    My.Computer.FileSystem.WriteAllText(sSMdbName & "\water4.per", "0" & vbCrLf, True, System.Text.Encoding.Default)
                Next
            End If
            FileOpen(fileNum, sSMdbName & "\water4.per", OpenMode.Input)
            If Not EOF(fileNum) Then
                For i = 0 To 14
                    strWatPrint(i) = LineInput(fileNum)
                Next
            End If
            FileClose(fileNum)
        End If

        '104.8.11 for scale2
        fileNum = FreeFile()
        file = My.Computer.FileSystem.FileExists(sSMdbName & "\scale2.sca")
        If file = False Then
            For i = 1 To 160 '(15):待拌槽 '104.8.15
                My.Computer.FileSystem.WriteAllText(sSMdbName & "\scale2.sca", "0" & vbCrLf, True, System.Text.Encoding.Default)
            Next
        End If

    End Sub
    Public Sub CheckDrog6()
        '111.4.4
        'check if C:\JS\OrigFile\New_datasample.mdb have Drog6

        Dim dbrec As New DbAccess("\JS\OrigFile\New_datasample.mdb")
        Dim dt_mdb As DataTable = dbrec.GetDataTable("SELECT * FROM recdata ;")
        Dim jj
        '111.4.6 orignal New_datasample.mdb 154 fields 
        jj = dt_mdb.Columns.Count
        If jj <= 154 Then
            Dim sql As String
            sql = "ALTER TABLE recdata ADD [Drog6] real NULL default 0 , "
            sql &= "[OrgDrog6] real NULL default 0 , "
            sql &= "[setDrog6] real NULL default 0 , "
            sql &= "[RemainDrog6] real NULL default 0 , "
            sql &= "[nowaterDrog6] real NULL default 0 ; "
            dbrec.ExecuteCmd(sql)
        End If
        dbrec.dispose()


    End Sub


    Public Sub ReadRemote()

        '105.7.22
        If Not bUseNetwork Then Exit Sub

        Dim file

        '105.6.26 B FORMULA SAVE
        '105.7.5
        'file = My.Computer.FileSystem.DirectoryExists(sTextBoxBpath & "\JS\CBC8\DATA_" & sProject)
        file = My.Computer.FileSystem.DirectoryExists(sTextBoxBpath & "\CBC8\DATA_" & sProject)
        If file = False Then
            Try
                'My.Computer.FileSystem.CreateDirectory(sTextBoxBpath & "\JS\CBC8\DATA_" & sProject)
                My.Computer.FileSystem.CreateDirectory(sTextBoxBpath & "\CBC8\DATA_" & sProject)
            Catch ex As Exception
                MsgBox(sTextBoxBpath & " not found! Please check NETWORK and REMOTE PC.")
                bRemoteBpath = False
            End Try
        End If
        '105.7.16
        If bRemoteBpath Then
            If Not My.Computer.FileSystem.FileExists(sYMdbName_B + sSavingYear + ".mdb") Then
                Try
                    My.Computer.FileSystem.CopyFile("C:\JS\OrigFile\New_datasample_f.mdb", sYMdbName_B + sSavingYear + ".mdb")
                Catch ex As Exception
                    '105.11.9
                    MsgBox("Copy " & sYMdbName_B + sSavingYear + ".mdb" & " fail!", MsgBoxStyle.Critical, "ReadRemote")
                End Try
            End If
        End If


        '105.7.5 A FORMULA REMOTE SAVE
        file = My.Computer.FileSystem.DirectoryExists(sRemoteApath & "\CBC8\DATA_" & sProject)
        If file = False Then
            Try
                My.Computer.FileSystem.CreateDirectory(sRemoteApath & "\CBC8\DATA_" & sProject)
            Catch ex As Exception
                MsgBox(sRemoteApath & " not found! Please check NETWORK and REMOTE PC.")
                bRemoteApath = False
            End Try
        End If
        If bRemoteApath Then
            If Not My.Computer.FileSystem.FileExists(sYMdbName_A + sSavingYear + ".mdb") Then
                Try
                    My.Computer.FileSystem.CopyFile("C:\JS\OrigFile\New_datasample_f.mdb", sYMdbName_A + sSavingYear + ".mdb")
                Catch ex As Exception
                    '105.11.9
                    'MsgBox("Copy " & sRemoteApath & sYMdbName_A & " fail!", MsgBoxStyle.Critical, "ReadRemote")
                    MsgBox("Copy " & sYMdbName_A + sSavingYear + ".mdb" & " fail!", MsgBoxStyle.Critical, "ReadRemote")
                    bRemoteApath = False
                End Try
            End If
        End If




    End Sub

    Public Sub ReadAlarm()
        '113.8.28
        '   FUSE ALARM
        '   D341-D356   保險絲燒毀bit(每個D 16bit) 由D33-12決定掃瞄
        ' Alarm D16~19, D29,37,40 15*7=105  ==> 16*(7+16+1)=384 
        '   D16..D356 23
        'Public AlarmDvMax As Integer = 23    'orig AlarmDV(7)
        'Public AlarmDvBitsMax As Integer = (AlarmDvMax + 1) * 16
        Dim i, j As Integer
        Dim Dreg As Integer
        Dim file
        file = My.Computer.FileSystem.DirectoryExists(sSMdbName)
        If file = False Then My.Computer.FileSystem.CreateDirectory(sSMdbName)
        file = My.Computer.FileSystem.FileExists(sSMdbName & "\Alarm.des")
        If file = False Then
            For i = 1 To AlarmDvMax
                Select Case i
                    Case 1 To 4
                        Dreg = i + 15   'D16~19
                    Case 5
                        Dreg = 29
                    Case 6
                        Dreg = 37
                    Case 7
                        Dreg = 40
                    Case Else   'D341-356
                        Dreg = i + 333
                End Select

                For j = 0 To 15
                    My.Computer.FileSystem.WriteAllText(sSMdbName & "\Alarm.des", "D" & Dreg & "-" & j & vbCrLf, True, System.Text.Encoding.Default)
                    My.Computer.FileSystem.WriteAllText(sSMdbName & "\Alarm.des", "1" & vbCrLf, True, System.Text.Encoding.Default)
                    My.Computer.FileSystem.WriteAllText(sSMdbName & "\Alarm.des", "Alarm" & Dreg & "_" & j & vbCrLf, True, System.Text.Encoding.Default)
                Next
            Next
        Else
            Dim s As String = "0.0"
            Dim fileNum
            fileNum = FreeFile()
            FileOpen(fileNum, sSMdbName & "\Alarm.des", OpenMode.Input)
            If Not EOF(fileNum) Then
                For j = 0 To (AlarmDvMax * 16 - 1)
                    AlarmName(j) = LineInput(fileNum)
                    AlarmType(j) = CInt(LineInput(fileNum))
                    AlarmDesc(j) = LineInput(fileNum)
                Next
                FileClose(fileNum)
            End If
        End If

    End Sub
    Public Sub ReadAlarm_old()
        Dim i, j As Integer
        Dim Dreg As Integer
        Dim file
        file = My.Computer.FileSystem.DirectoryExists(sSMdbName)
        If file = False Then My.Computer.FileSystem.CreateDirectory(sSMdbName)
        file = My.Computer.FileSystem.FileExists(sSMdbName & "\Alarm.des")
        If file = False Then
            For i = 1 To 7
                Select Case i
                    Case 1 To 4
                        Dreg = i + 15   'D16~19
                    Case 5
                        Dreg = 29
                    Case 6
                        Dreg = 37
                    Case Else
                        Dreg = 40
                End Select

                For j = 1 To 15
                    My.Computer.FileSystem.WriteAllText(sSMdbName & "\Alarm.des", "D" & Dreg & "-" & j & vbCrLf, True, System.Text.Encoding.Default)
                    My.Computer.FileSystem.WriteAllText(sSMdbName & "\Alarm.des", "1" & vbCrLf, True, System.Text.Encoding.Default)
                    My.Computer.FileSystem.WriteAllText(sSMdbName & "\Alarm.des", "Alarm" & Dreg & j & vbCrLf, True, System.Text.Encoding.Default)
                Next
            Next
        Else
            Dim s As String = "0.0"
            Dim fileNum
            fileNum = FreeFile()
            FileOpen(fileNum, sSMdbName & "\Alarm.des", OpenMode.Input)
            If Not EOF(fileNum) Then
                For j = 0 To 104
                    AlarmName(j) = LineInput(fileNum)
                    AlarmType(j) = CInt(LineInput(fileNum))
                    AlarmDesc(j) = LineInput(fileNum)
                Next
                FileClose(fileNum)
            End If
        End If

    End Sub
    Public Sub ReadCement()
        '102.11.25
        Dim j As Integer
        'Dim dtconfig As DataTable
        'dtconfig = db.GetDataTable("select PLC_Address, Alarm_Type, Alarm_Desc from Alarm_Setting order by PLC_Address")
        'For i = 0 To 63
        '    AlarmType(i) = dtconfig.Rows(i).Item(1).ToString
        '    AlarmType(i) = dtconfig.Rows(i).Item(1).ToString
        '    AlarmDesc(i) = dtconfig.Rows(i).Item(2).ToString
        'Next

        Dim file
        file = My.Computer.FileSystem.DirectoryExists(sSMdbName)
        If file = False Then My.Computer.FileSystem.CreateDirectory(sSMdbName)
        file = My.Computer.FileSystem.FileExists(sSMdbName & "\Cement.des")
        If file = False Then

            For j = 1 To 6
                My.Computer.FileSystem.WriteAllText(sSMdbName & "\Cement.des", "泥" & j & vbCrLf, True, System.Text.Encoding.Default)
                My.Computer.FileSystem.WriteAllText(sSMdbName & "\Cement.des", "水泥" & j & vbCrLf, True, System.Text.Encoding.Default)
                My.Computer.FileSystem.WriteAllText(sSMdbName & "\Cement.des", "0" & vbCrLf, True, System.Text.Encoding.Default)
            Next
            For j = 7 To 11
                My.Computer.FileSystem.WriteAllText(sSMdbName & "\Cement.des", "藥" & (j - 6) & vbCrLf, True, System.Text.Encoding.Default)
                My.Computer.FileSystem.WriteAllText(sSMdbName & "\Cement.des", "藥劑" & (j - 6) & vbCrLf, True, System.Text.Encoding.Default)
                My.Computer.FileSystem.WriteAllText(sSMdbName & "\Cement.des", "0" & vbCrLf, True, System.Text.Encoding.Default)
            Next
        Else
            Dim s As String = "0.0"
            Dim fileNum
            fileNum = FreeFile()
            FileOpen(fileNum, sSMdbName & "\Cement.des", OpenMode.Input)
            If Not EOF(fileNum) Then
                For j = 0 To 10
                    strCementName(j) = LineInput(fileNum)
                    strCement(j) = LineInput(fileNum)
                    strCementEnable(j) = LineInput(fileNum)
                Next
                FileClose(fileNum)
            End If
        End If

    End Sub

    Public Sub ReadOffset()
        '111.11.30 print offset 列印調整
        '111.11.30
        Dim file
        file = My.Computer.FileSystem.DirectoryExists(sSMdbName & "")
        If file = False Then My.Computer.FileSystem.CreateDirectory(sSMdbName & "")
        file = My.Computer.FileSystem.FileExists(sSMdbName & "\Offset.des")
        Dim fileNum
        Dim j
        If file = False Then
            fileNum = FreeFile()
            FileOpen(fileNum, sSMdbName & "\Offset.des", OpenMode.Output)
            For j = 0 To 25
                PrintLine(fileNum, "0")
                mat_offset(j) = 0
            Next
            For j = 0 To 25
                PrintLine(fileNum, "0")
                mat_offset_sp(j) = 0
            Next
            PrintLine(fileNum, "0")
            mat_offset_tot = 0
            FileClose(fileNum)
        Else
            Dim s As String = "0.0"
            fileNum = FreeFile()
            FileOpen(fileNum, sSMdbName & "\Offset.des", OpenMode.Input)
            If Not EOF(fileNum) Then
                For j = 0 To 25
                    Try
                        mat_offset(j) = LineInput(fileNum)
                    Catch ex As Exception
                        mat_offset(j) = 0
                    End Try
                Next
                For j = 0 To 25
                    Try
                        mat_offset_sp(j) = LineInput(fileNum)
                    Catch ex As Exception
                        mat_offset_sp(j) = 0
                    End Try
                Next
                Try
                    mat_offset_tot = LineInput(fileNum)
                Catch ex As Exception
                    mat_offset_tot = 0
                End Try
                FileClose(fileNum)
            End If
        End If

    End Sub

    Public Sub ReadAE15()
        '102.11.25 105.5.12 ref ReadCement
        Dim j As Integer

        Dim file
        file = My.Computer.FileSystem.DirectoryExists(sSMdbName)
        If file = False Then My.Computer.FileSystem.CreateDirectory(sSMdbName)
        file = My.Computer.FileSystem.FileExists(sSMdbName & "\AE15.des")
        If file = False Then
            For j = 1 To 15
                My.Computer.FileSystem.WriteAllText(sSMdbName & "\AE15.des", "A" & j & vbCrLf, True, System.Text.Encoding.Default)
                My.Computer.FileSystem.WriteAllText(sSMdbName & "\AE15.des", "AE1-" & j & vbCrLf, True, System.Text.Encoding.Default)
            Next
        Else
            Dim s As String = "0.0"
            Dim fileNum
            fileNum = FreeFile()
            FileOpen(fileNum, sSMdbName & "\AE15.des", OpenMode.Input)
            If Not EOF(fileNum) Then
                For j = 1 To 15
                    s = LineInput(fileNum)
                    strAE15Name(j) = LineInput(fileNum)
                Next
                FileClose(fileNum)
            End If
        End If
    End Sub
    '2011.5.1
    Public Sub Thread_PrintCarDetail(ByVal sUniCar As String, ByVal sCarSer As String, ByVal table_name As String)
        Dim arrdb_org() As String = {"Orgsand1", "Orgsand2", "Orgsand3", "Orgsand4", "Orgstone1", "Orgstone2", "Orgstone3", "Orgstone4", _
        "Orgwater1", "Orgwater2", "Orgwater3", "Orgconcrete1", "Orgconcrete2", "Orgconcrete3", "Orgconcrete4", "Orgconcrete5", _
        "Orgconcrete6", "Orgdrog1", "Orgdrog2", "Orgdrog3", "Orgdrog4", "Orgdrog5", "Orgmaterial1", "Orgmaterial2", "Orgmaterial3"}
        Dim arrdb_real() As String = {"sand1", "sand2", "sand3", "sand4", "stone1", "stone2", "stone3", "stone4", _
       "water1", "water2", "water3", "concrete1", "concrete2", "concrete3", "concrete4", "concrete5", _
       "concrete6", "drog1", "drog2", "drog3", "drog4", "drog5", "material1", "material2", "material3"}
        Dim arrdb_set() As String = {"setsand1", "setsand2", "setsand3", "setsand4", "setstone1", "setstone2", "setstone3", "setstone4", _
        "setwater1", "setwater2", "setwater3", "setconcrete1", "setconcrete2", "setconcrete3", "setconcrete4", "setconcrete5", _
        "setconcrete6", "setdrog1", "setdrog2", "setdrog3", "setdrog4", "setdrog5", "setmaterial1", "setmaterial2"}
        Dim arrdb_remain() As String = {"remainsand1", "remainsand2", "remainsand3", "remainsand4", "remainstone1", "remainstone2", "remainstone3", "remainstone4", _
        "remainwater1", "remainwater2", "remainwater3", "remainconcrete1", "remainconcrete2", "remainconcrete3", "remainconcrete4", "remainconcrete5", _
        "remainconcrete6", "remaindrog1", "remaindrog2", "remaindrog3", "remaindrog4", "remaindrog5", "remainmaterial1", "remainmaterial2", "remainmaterial3"}
        Dim arrdb_water() As String = {"WaterCompsand1", "WaterCompsand2", "WaterCompsand3", "WaterCompsand4", _
        "WaterCompstone1", "WaterCompstone2", "WaterCompstone3", "WaterCompstone4"}
        'db_sum = db.GetDataTable(strsqlall)
        '100.4.18
        'dbfile = sYMdbName & start_day.Value.Year & ".mdb"
        Dim dbrec As New DbAccess("Y2010.mdb")
        Dim dbfile As String
        'dbfile = sYMdbName & start_day.Value.Year & "M" & start_day.Value.Month & ".mdb"
        dbfile = sYMdbName & sSavingYear & ".mdb"
        dbrec = New DbAccess(dbfile)
        Dim db_sum As DataTable
        Dim i, j As Integer
        'Dim str2 As String
        Dim st As String
        Dim strTemp As String
        Dim itemCount As Integer
        Dim item_tap As Integer
        Dim sum As Single
        Dim m3tot As Single
        Dim f, f2, f3 As Single
        Dim tot(25) As Single
        Dim errp As Single
        Dim str_spare As String = "6"
        Dim strsql As String 'batch生產為一序號
        Dim repdetail As String
        Dim lineCnt As Integer
        Dim lineHeight As Single

        dbrec.changedb(sYMdbName + sSavingYear + ".mdb")


        'str = DataGridView1.Rows(j).Cells(0).Value
        'If CheckBoxB.Checked Then
        '    strsql = "select * from recdata_B where UniCar ='" & sUniCar & "'" & " AND CarSer =" & sCarSer
        'ElseIf CheckBoxSim.Checked Then
        '    strsql = "select * from recdata_sim where UniCar ='" & sUniCar & "'" & " AND CarSer =" & sCarSer
        'Else
        '    'strsql = "select * from recdata where UniCar ='" + sUniCar + "'"
        '    strsql = "select * from recdata where UniCar ='" & sUniCar & "'" & " AND CarSer =" & sCarSer
        'End If
        strsql = "select * from " & table_name & " where UniCar ='" & sUniCar & "'" & " AND CarSer =" & sCarSer
        db_sum = dbrec.GetDataTable(strsql)
        Try
            dbrec.ExecuteCmd(strsql)
        Catch ex As Exception
            MsgBox("資料庫查詢資料失敗")
        End Try
        'DataGridView1.Visible = False
        'DataGridView2.DataSource = db_sum
        'DataGridView2.Visible = True
        For i = 0 To 24
            tot(i) = 0
        Next
        m3tot = 0

        'i = db_sum.Columns.Count '107
        repdetail = ""
        Dim iPan As Integer
        For iPan = 0 To db_sum.Rows.Count - 1
            If iPan = 0 Then
                lineCnt = 0
                repdetail = "配比料號:"
                lineCnt += 1
                st = db_sum.Rows(0).Item("Fomula").ToString
                repdetail += Microsoft.VisualBasic.Left(st & "        ", 8)
                repdetail += "方數:"
                st = db_sum.Rows(0).Item(102).ToString
                repdetail += Microsoft.VisualBasic.Left(Format(db_sum.Rows(0).Item("TotalCube"), "0.00") & "        ", 6)
                repdetail += "車號:"
                st = db_sum.Rows(0).Item("Car").ToString
                repdetail += Microsoft.VisualBasic.Left(st & "        ", 8)
                repdetail += "工地:"
                st = db_sum.Rows(0).Item("Field").ToString
                repdetail += Microsoft.VisualBasic.Left(st & "        ", 8)
                repdetail += "設計強度:"
                st = db_sum.Rows(0).Item("Strength").ToString
                repdetail += Microsoft.VisualBasic.Left(st & "        ", 12)
                repdetail += "拌合機:#"
                st = sMixerNo
                repdetail += Microsoft.VisualBasic.Left(st & "        ", 8)

            End If
            repdetail += vbCrLf
            lineCnt += 1

            strTemp = "序 項目"
            '99.10.03strTemp = "序   項目"
            For j = 0 To arrdb_real.Length - 1
                If MainForm.exist(j) = True Then
                    strTemp += Microsoft.VisualBasic.Right("        " & MatName(j), 6 - Len(MatName(j)))
                    matLen += Len(MatName(j))
                    itemCount += 1
                End If
            Next
            strTemp += "  總計"
            strTemp += vbCrLf
            lineCnt += 1
            'lineLen = Len(strTemp) + matLen + 2
            lineLen = 10 + itemCount * 6 + 6
            repdetail += strTemp
            startDateTime = Convert.ToDateTime(db_sum.Rows(0).Item("RecDT"))

            st = db_sum.Rows(iPan).Item("Plate").ToString
            strTemp = st & ":"
            strTemp += Microsoft.VisualBasic.Right("        " & Format(db_sum.Rows(iPan).Item("Cube"), "0.00"), 5)
            '99.10.03strTemp = st & " :"
            'strTemp += Microsoft.VisualBasic.Right("        " & Format(db_sum.Rows(iPan).Item("Cube"), "0.00"), 6)
            m3tot += db_sum.Rows(iPan).Item("Cube")
            strTemp += " M3"   '立方
            stopDateTime = Convert.ToDateTime(db_sum.Rows(iPan).Item("RecDT"))
            strTemp += " " & stopDateTime & " "
            repdetail += strTemp
            '99.10.03For i = 0 To lineLen - Len(strTemp) - 2
            For i = 0 To lineLen - Len(strTemp) - 4
                repdetail += "-"
            Next
            repdetail += vbCrLf
            lineCnt += 1
            item_tap = 7
            '99.10.03item_tap = 9

            If print1M3 Then
                repdetail += Microsoft.VisualBasic.Right("        " & "配比", item_tap - 2)
                sum = 0
                For i = 0 To arrdb_real.Length - 1
                    If MainForm.exist(i) Then
                        If MatType(i) = "A" Then
                            repdetail += Microsoft.VisualBasic.Right("        " & Format(db_sum.Rows(iPan).Item(arrdb_org(i)), "0.00"), 6)
                        Else
                            repdetail += Microsoft.VisualBasic.Right("        " & Format(db_sum.Rows(iPan).Item(arrdb_org(i)), "0"), 6)
                        End If
                        sum += db_sum.Rows(iPan).Item(arrdb_org(i))
                    End If
                Next
                repdetail += Microsoft.VisualBasic.Right("        " & Format(sum, "0"), 6)
                'repdetail += String.Format("{0," + str_spare + "}", sum)
                'repdetail += String.Format("{0," + str_spare + "}", db_sum.Rows(0).Item(24).ToString)
                repdetail += vbCrLf
                lineCnt += 1
            End If

            If printSP Then
                repdetail += Microsoft.VisualBasic.Right("        " & "設定值", item_tap - 3)
                sum = 0
                For i = 0 To arrdb_real.Length - 1
                    If MainForm.exist(i) Then
                        If MatType(i) = "A" Then
                            repdetail += Microsoft.VisualBasic.Right("        " & Format(db_sum.Rows(iPan).Item(arrdb_set(i)), "0.00"), 6)
                        Else
                            repdetail += Microsoft.VisualBasic.Right("        " & Format(db_sum.Rows(iPan).Item(arrdb_set(i)), "0"), 6)
                        End If
                        sum += db_sum.Rows(iPan).Item(arrdb_set(i))
                    End If
                Next
                repdetail += Microsoft.VisualBasic.Right("        " & Format(sum, "0"), 6)
                'repdetail += String.Format("{0," + str_spare + "}", sum)
                repdetail += vbCrLf
                lineCnt += 1
            End If
            If printPV Then
                repdetail += Microsoft.VisualBasic.Right("        " & "計量值", item_tap - 3)
                sum = 0
                For i = 0 To arrdb_real.Length - 1
                    If MainForm.exist(i) Then
                        If printREMAIN Then
                            f2 = CSng(db_sum.Rows(iPan).Item(arrdb_real(i)))
                            f = CSng(Format(f2, "0.00"))
                        Else
                            f2 = CSng(db_sum.Rows(iPan).Item(arrdb_real(i)) - db_sum.Rows(iPan).Item(arrdb_remain(i)))
                            f = CSng(Format(f2, "0.00"))
                        End If
                        If MatType(i) = "A" Then
                            repdetail += Microsoft.VisualBasic.Right("        " & Format(f, "0.00"), 6)
                        Else
                            'repdetail += Microsoft.VisualBasic.Right("        " &     Format(db_sum.Rows(iPan).Item(arrdb_real(i)), "0"), 6)

                            repdetail += Microsoft.VisualBasic.Right("        " & Format(f, "0"), 6)
                        End If
                        sum += db_sum.Rows(iPan).Item(arrdb_real(i))
                        tot(i) += f
                    End If
                Next
                repdetail += Microsoft.VisualBasic.Right("        " & Format(sum, "0"), 6)
                'repdetail += String.Format("{0," + str_spare + "}", sum)
                repdetail += vbCrLf
                lineCnt += 1
            End If
            Dim s As String
            If printREMAIN Then
                repdetail += Microsoft.VisualBasic.Right("        " & "殘留值", item_tap - 3)
                sum = 0
                For i = 0 To arrdb_real.Length - 1
                    If MainForm.exist(i) Then
                        If MatType(i) = "A" Then
                            repdetail += Microsoft.VisualBasic.Right("        " & Format(db_sum.Rows(iPan).Item(arrdb_remain(i)), "0.00"), 6)
                        Else
                            repdetail += Microsoft.VisualBasic.Right("        " & Format(db_sum.Rows(iPan).Item(arrdb_remain(i)), "0"), 6)
                        End If
                        sum += db_sum.Rows(iPan).Item(arrdb_remain(i))
                        tot(i) -= db_sum.Rows(iPan).Item(arrdb_remain(i))
                    End If
                    s = db_sum.Rows(iPan).Item(arrdb_remain(i))
                Next
                repdetail += Microsoft.VisualBasic.Right("        " & Format(sum, "0"), 6)
                repdetail += vbCrLf
                lineCnt += 1
            End If


            If printERR Then
                repdetail += Microsoft.VisualBasic.Right("        " & "誤差率", item_tap - 3)
                For i = 0 To arrdb_real.Length - 1
                    If MainForm.exist(i) Then
                        f = CSng(db_sum.Rows(iPan).Item(arrdb_set(i)))
                        If f > 0 Then
                            f2 = CSng(db_sum.Rows(iPan).Item(arrdb_real(i)))
                            If MatType(i) = "A" Then
                                f3 = CSng(Format(f2, "0.00"))
                            Else
                                f3 = CSng(Format(f2, "0"))
                            End If
                            errp = 100 * (f3 - CSng(db_sum.Rows(iPan).Item(arrdb_remain(i))) - CSng(db_sum.Rows(iPan).Item(arrdb_set(i)))) / f
                            'errp = 100 * (CSng(db_sum.Rows(iPan).Item(arrdb_real(i))) - CSng(db_sum.Rows(iPan).Item(arrdb_remain(i))) - CSng(db_sum.Rows(iPan).Item(arrdb_set(i)))) / f
                            repdetail += Microsoft.VisualBasic.Right("        " & Format(errp, "0.0"), 6)
                        Else
                            repdetail += Microsoft.VisualBasic.Right("        " & Format(0, "0.0"), 6)
                        End If
                    End If
                Next
                repdetail += vbCrLf
                lineCnt += 1
            End If


            If printWATER Then
                repdetail += Microsoft.VisualBasic.Right("        " & "含水率", item_tap - 3)
                For i = 0 To 7
                    If MainForm.exist(i) Then
                        f = db_sum.Rows(iPan).Item(arrdb_water(i))
                        repdetail += Microsoft.VisualBasic.Right("        " & Format(f, "0.0"), 6)
                    End If
                Next
                repdetail += vbCrLf
                lineCnt += 1
            End If

            If iPan = db_sum.Rows.Count - 1 Then
                strTemp = "日期:" & startDateTime.ToString & " ~ " & stopDateTime & " "
                repdetail += strTemp
                '99.10.03For i = 0 To lineLen - Len(strTemp) - 4
                For i = 0 To lineLen - Len(strTemp) - 6
                    repdetail += "*"
                Next
                repdetail += vbCrLf
                lineCnt += 1
                repdetail += "計"
                '99.10.03repdetail += "總計"
                repdetail += Microsoft.VisualBasic.Right("        " & Format(m3tot, "0.00"), 5)
                sum = 0
                For i = 0 To arrdb_real.Length - 1
                    If MainForm.exist(i) Then
                        If MatType(i) = "A" Then
                            repdetail += Microsoft.VisualBasic.Right("        " & Format(tot(i), "0.00"), 6)
                        Else
                            repdetail += Microsoft.VisualBasic.Right("        " & Format(tot(i), "0"), 6)
                        End If
                        sum += tot(i)
                    End If
                Next
                'repdetail += String.Format("{0," + str_spare + "}", sum)
                repdetail += Microsoft.VisualBasic.Right("        " & Format(sum, "0"), 6)
                repdetail += vbCrLf
                lineCnt += 1
                'lineCnt += 1

            End If

        Next
        lineHeight = 19
        'Dim ps As New System.Drawing.Printing.PaperSize("CBC8_4", 900, (1 + lineCnt) * lineHeight)
        'PageSetupDialog1.PageSettings.PaperSize = ps
    End Sub
    Public Function FixStr(ByVal s As String, ByVal l As Integer, ByVal type As String) As String
        Dim sr As String
        Dim C_len, j As Integer
        sr = ""
        For j = 1 To Len(s)
            If AscW(Mid(s, j, 1)) > 127 Then C_len += 1
        Next
        If type = "L" Then
            sr &= Microsoft.VisualBasic.Left(s & "                      ", l - C_len)
        Else
            sr &= Microsoft.VisualBasic.Right("                     " & s, l - C_len)
            'sr &= Microsoft.VisualBasic.Right("****************" & s, l - C_len)
        End If
        Return sr
    End Function
    Public Sub CreateTrendFile(ByVal s As String)
        '104.8.8
        Dim file
        Dim ss, sss As Single
        Dim j As Integer
        Dim generator As New Random

        file = My.Computer.FileSystem.DirectoryExists("\JS\cbc8\trend")
        If file = False Then My.Computer.FileSystem.CreateDirectory("\JS\cbc8\trend")
        file = My.Computer.FileSystem.FileExists("\JS\cbc8\trend\" & s & ".tnd")
        Dim fileNum
        fileNum = FreeFile()
        FileOpen(fileNum, "\JS\cbc8\trend\" & s & ".tnd", OpenMode.Output)
        sss = 20
        For j = 0 To 199
            ss = generator.Next(1, 10) + sss - 4
            PrintLine(fileNum, Trim(ss.ToString))
            sss = ss
        Next
        FileClose(fileNum)
    End Sub
    Public Sub SaveTrendFile(ByVal s As String)
        '104.8.8
        Dim file
        Dim j As Integer
        Dim generator As New Random

        file = My.Computer.FileSystem.DirectoryExists("\JS\cbc8\trend")
        If file = False Then My.Computer.FileSystem.CreateDirectory("\JS\cbc8\trend")
        file = My.Computer.FileSystem.FileExists("\JS\cbc8\trend\" & s & ".tnd")
        Dim fileNum
        fileNum = FreeFile()
        FileOpen(fileNum, "\JS\cbc8\trend\" & s & ".tnd", OpenMode.Output)
        '104.12.24
        'For j = 0 To 199
        For j = 0 To 299
            PrintLine(fileNum, iTrendSave(j).ToString)
        Next
        FileClose(fileNum)
    End Sub
    Public Function resendSqlDay(ByVal dateFind As String, ByVal typeDR As String) As Integer
        '112.2.17
        'find all records in the mdb with dataFind , check each rec with all hhmmss in receia/b

        Dim iUnMatched = 0
        Dim strConA_D1 As String()  'all hhmmss in the day
        'Dim strConA_R1 As String()
        Dim strConB_D1 As String()  'all hhmmss in the day
        'Dim strConB_R1 As String()
        'dateFind = DateTimePicker1.Value.Year & Format(DateTimePicker1.Value.Month, "00") & Format(i + 1, "00")
        'dateFind = "20220802"
        'strConA_R1 = findconscbujihhmmss(dateFind, "R1", "receia")
        'strConB_D1 = findconscbujihhmmss(dateFind, "D1", "receib")
        'strConB_R1 = findconscbujihhmmss(dateFind, "R1", "receib")
        Dim sMdb, sSavingYyyyM As String
        Dim strsqlall As String
        If typeDR = "D" Then
            '112.2.17
            'strConA_D1 = findconscbujihhmmss(dateFind, "D1", "receia")
            'strConB_D1 = findconscbujihhmmss(dateFind, "D1", "receib")
            strConA_D1 = findconscbujihhmmss(dateFind, "D1", "receia", "conscbuji")
            strConB_D1 = findconscbujihhmmss(dateFind, "D1", "receib", "conscbuji")
            sMdb = sYMdbName
            strsqlall = "Select DISTINCT * from recdata WHERE format(SaveDT, 'yyyyMMdd') ='" & dateFind & "' ORDER BY RecDT ASC "
        Else
            '112.2.17
            'strConA_D1 = findconscbujihhmmss(dateFind, "R1", "receia")
            'strConB_D1 = findconscbujihhmmss(dateFind, "R1", "receib")
            strConA_D1 = findconscbujihhmmss(dateFind, "R1", "receia", "conscbuji")
            strConB_D1 = findconscbujihhmmss(dateFind, "R1", "receib", "conscbuji")
            sMdb = sYMdbName_B
            strsqlall = "Select DISTINCT * from recdata_b WHERE format(SaveDT, 'yyyyMMdd') ='" & dateFind & "' ORDER BY RecDT ASC "
        End If

        '111.10.21
        RecSqlLog.add = "dateFind = " & dateFind
        RecSqlLog.add = "typeDR = " & typeDR
        RecSqlLog.add = "receia : " & typeDR
        Dim i, j As Integer
        RecSqlLog.add = "strConA_D1.Length : " & strConA_D1.Length
        For i = 0 To strConA_D1.Length - 1
            RecSqlLog.add = i & " , " & strConA_D1(i)
        Next
        RecSqlLog.add = "typeDR = " & typeDR
        RecSqlLog.add = "receib : " & typeDR
        RecSqlLog.add = "strConB_D1.Length : " & strConB_D1.Length
        For i = 0 To strConB_D1.Length - 1
            RecSqlLog.add = i & " , " & strConB_D1(i)
        Next

        'Dim db_recData As New DbAccess(sMdb & sSavingYear & ".mdb")
        sSavingYyyyM = Microsoft.VisualBasic.Left(dateFind, 4) & "M" & CInt(Microsoft.VisualBasic.Mid(dateFind, 5, 2)).ToString
        Dim db_recData As New DbAccess(sMdb & sSavingYyyyM & ".mdb")
        Dim dt_recData As DataTable
        '112.9.23
        'dt_recData = db_recData.GetDataTable(strsqlall)
        Try
            dt_recData = db_recData.GetDataTable(strsqlall)
            j = dt_recData.Rows.Count
        Catch ex As Exception
            MsgBox(ex.Message)
            '112.9.23
            resendSqlDay = -99
            Exit Function
        End Try
        RecSqlLog.add = "dt_recData.Rows.Count : " & j
        For i = 0 To j - 1
            Application.DoEvents()
            Dim reciaReadHeader As New ClassReceiaHeader(dt_recData.Rows(i))
            Dim receiaPan As New classReceiaPan()
            Dim Dt As Date
            Dt = dt_recData.Rows(i).Item("RecDT")
            Dim ct = checkSavedtHmsInconscbuji(Dt, strConA_D1)
            Dim ctB = checkSavedtHmsInconscbuji(Dt, strConB_D1)
            '111.9.22 if receia no data (ct=0) send to receib
            'If ct = 0 Then
            If ct = 0 And ctB = 0 Then
                iUnMatched += 1
                Dim hhmmss
                hhmmss = Format(Hour(Dt), "00") & Format(Minute(Dt), "00") & Format(Second(Dt), "00")
                RecSqlLog.add = i & " , " & iUnMatched & " , " & hhmmss
                'yymodd = Format(Year(dt1), "0000") & Format(Month(dt1), "00") & Format(Microsoft.VisualBasic.DateAndTime.Day(dt1), "00")
                'MainForm.LabelMessage2.Text = " 補傳......" & (iUnMatched)
                'MainForm.LabelMessage2.Refresh()
                receiaPan.Header = reciaReadHeader
                Dim s As String
                s = receiaPan.Header.hhmmssLast
                receiaPan.D2.valRec = receiaPan.fillRecCat(dt_recData.Rows(i), "org")
                receiaPan.D3.valRec = receiaPan.fillRecCat(dt_recData.Rows(i), "set")
                receiaPan.D4.valRec = receiaPan.fillRecCat(dt_recData.Rows(i), "")
                receiaPan.D5.valRec = receiaPan.fillRecCat(dt_recData.Rows(i), "remain")
                receiaPan.D6.valRec = receiaPan.fillRecErrPer(receiaPan.D3.valRec, receiaPan.D4.valRec, receiaPan.D5.valRec)
                receiaPan.D7.valRec = receiaPan.fillRecWaterComp(dt_recData.Rows(i), "Watercomp")
                '總盤數 = 盤數 => DT/RT
                If receiaPan.Header.sumno = receiaPan.Header.no Then
                    strsqlall = "Select SUM(sand1),SUM(sand2),SUM(sand3),SUM(sand4),SUM(Stone1),SUM(Stone2),SUM(Stone3),SUM(Stone4),SUM(Water1),SUM(Water2),SUM(Water3)"
                    strsqlall &= ",SUM(Concrete1),SUM(Concrete2),SUM(Concrete3),SUM(Concrete4),SUM(Concrete5),SUM(Concrete6)"
                    'strsqlall &= ",SUM(Drog1),SUM(Drog2),SUM(Drog3),SUM(Drog4),SUM(Drog5),SUM(cube) from recdata WHERE [UniCar] ='" & receiaPan.Header.UniCar & "'"
                    If typeDR = "D" Then
                        strsqlall &= ",SUM(Drog1),SUM(Drog2),SUM(Drog3),SUM(Drog4),SUM(Drog5),SUM(cube) from recdata WHERE [UniCar] ='" & receiaPan.Header.UniCar & "'"
                    Else
                        strsqlall &= ",SUM(Drog1),SUM(Drog2),SUM(Drog3),SUM(Drog4),SUM(Drog5),SUM(cube) from recdata_b WHERE [UniCar] ='" & receiaPan.Header.UniCar & "'"
                    End If
                    Dim db_Dt As New DataTable
                    db_Dt = db_recData.GetDataTable(strsqlall)
                    '111.11.18 bug for DT 
                    receiaPan.Header.hhmmssLast = hhmmss
                    'receiaPan.Header.hhmmssLast = Format(db_sum.Rows(jj).Item("RecDT"), "HHmmss")

                    '112.4.19 bug:only sum no remain
                    strsqlall = "Select SUM(remainsand1),SUM(remainsand2),SUM(remainsand3),SUM(remainsand4),SUM(remainStone1),SUM(remainStone2),SUM(remainStone3),SUM(remainStone4),SUM(remainWater1),SUM(remainWater2),SUM(remainWater3)"
                    strsqlall &= ",SUM(remainConcrete1),SUM(remainConcrete2),SUM(remainConcrete3),SUM(remainConcrete4),SUM(remainConcrete5),SUM(remainConcrete6)"
                    If typeDR = "D" Then
                        strsqlall &= ",SUM(remainDrog1),SUM(remainDrog2),SUM(remainDrog3),SUM(remainDrog4),SUM(remainDrog5),SUM(cube) from recdata WHERE [UniCar] ='" & receiaPan.Header.UniCar & "'"
                    Else
                        strsqlall &= ",SUM(remainDrog1),SUM(remainDrog2),SUM(remainDrog3),SUM(remainDrog4),SUM(remainDrog5),SUM(cube) from recdata_b WHERE [UniCar] ='" & receiaPan.Header.UniCar & "'"
                    End If
                    Dim db_Dt_rem As New DataTable
                    db_Dt_rem = db_recData.GetDataTable(strsqlall)

                    If db_Dt.Rows.Count > 0 Then
                        '112.4.19
                        'receiaPan.DT.valRec = receiaPan.fillRecDTRT(db_Dt.Rows(0))
                        receiaPan.DT.valRec = receiaPan.fillRecDTRT(db_Dt.Rows(0), db_Dt_rem.Rows(0))
                        receiaPan.DT.qty = db_Dt.Rows(0).Item(22)
                    End If
                    '112.1.13
                    'Dim send = receiaPan.sendSqlToconscbujiRecei(receiaPan.getSendRecSqlStr("receib", typeDR, True))
                    Dim send = receiaPan.sendSqlToconscbujiRecei(receiaPan.getSendRecSqlStr("receib", typeDR, True), "A")
                    '112.4.12
                    If bPingSQLBigData Then
                        send = receiaPan.sendSqlToconscbujiRecei(receiaPan.getSendRecSqlStr("receib", typeDR, True), "B")
                    End If

                Else
                    '112.1.13
                    'Dim send = receiaPan.sendSqlToconscbujiRecei(receiaPan.getSendRecSqlStr("receib", typeDR, False))
                    Dim send = receiaPan.sendSqlToconscbujiRecei(receiaPan.getSendRecSqlStr("receib", typeDR, False), "A")
                    '112.4.12
                    If bPingSQLBigData Then
                        send = receiaPan.sendSqlToconscbujiRecei(receiaPan.getSendRecSqlStr("receib", typeDR, False), "B")
                    End If
                End If
            End If
        Next
        db_recData.dispose()
        dt_recData.Dispose()
        resendSqlDay = iUnMatched
    End Function
    Public Function findconscbujihhmmss(ByVal yymodd As String, ByVal D1R1 As String, ByVal recei As String, ByVal dbDest As String) As String()
        '112.2.17
        'Dim dbrec As New SQLDbAccess("conscbuji")
        Dim dbrec
        'Dim dbDest As String = ""
        If dbDest = "conscbuji" Then
            dbrec = New SQLDbAccess("conscbuji")
        Else
            dbrec = New SQLDbAccess2(dbDest, sBigDataDataBaseIP)
        End If
        Dim dtrec As DataTable
        Dim strsqlall As String
        Dim strCon() As String
        'hhmmss = Format(Hour(dt1), "00") & Format(Minute(dt1), "00") & Format(Second(dt1), "00")
        'yymodd = Format(Year(dt1), "0000") & Format(Month(dt1), "00") & Format(Microsoft.VisualBasic.DateAndTime.Day(dt1), "00")
        'strsqlall = "Select DISTINCT yymodd,hhmmss,category, bujino from receia where ([category]='D1'  OR [category]='R1') AND [yymodd] ='" & yymodd & "' AND [hhmmss] ='" & hhmmss & "' GROUP BY [yymodd],[hhmmss],[category],[bujino] "
        'strsqlall = "Select DISTINCT yymodd,category, bujino from receia where ([category]='D1'  OR [category]='R1') AND [yymodd] ='" & yymodd & "' GROUP BY [yymodd],[category],[bujino] "
        'strsqlall = "Select DISTINCT yymodd,hhmmss,category, bujino from receia where [category]='D1' AND [yymodd] ='" & yymodd & "' GROUP BY [yymodd],[hhmmss],[category],[bujino] "
        strsqlall = "Select DISTINCT yymodd,hhmmss,category, bujino from " & recei & " where [category]='" & D1R1 & "' AND [yymodd] ='" & yymodd & "' GROUP BY [yymodd],[hhmmss],[category],[bujino] "
        dtrec = dbrec.GetDataTable(strsqlall)

        Dim i
        ReDim strCon(dtrec.Rows.Count - 1)
        For i = 0 To dtrec.Rows.Count - 1
            strCon(i) = dtrec.Rows(i).Item("hhmmss")
        Next
        findconscbujihhmmss = strCon
        dbrec.dispose()
    End Function
    Public Function checkSavedtHmsInconscbuji(ByVal dt1 As Date, ByVal stDt As String()) As Integer
        Dim hhmmss, yymodd As String
        hhmmss = Format(Hour(dt1), "00") & Format(Minute(dt1), "00") & Format(Second(dt1), "00")
        yymodd = Format(Year(dt1), "0000") & Format(Month(dt1), "00") & Format(Microsoft.VisualBasic.DateAndTime.Day(dt1), "00")
        Dim i = 0, s
        For Each s In stDt
            If hhmmss = s Then
                i = 1
                Exit For
            End If
        Next
        checkSavedtHmsInconscbuji = i
    End Function

    Public Function Min(ByVal s1 As Single, ByVal s2 As Single) As Single
        '104.9.6
        If s1 > s2 Then
            Return s2
        Else
            Return s1
        End If
    End Function

    Public Function Max(ByVal s1 As Single, ByVal s2 As Single) As Single
        '104.9.6
        If s1 < s2 Then
            Return s2
        Else
            Return s1
        End If
    End Function
    Public Sub ReadAdmin2()
        '107.7.9 still use Admin
        '107.7.4
        '105.7.19
        Dim file
        Dim fileNum
        Dim i = 0
        file = My.Computer.FileSystem.DirectoryExists(sSMdbName & "")
        If file = False Then My.Computer.FileSystem.CreateDirectory(sSMdbName & "")
        file = My.Computer.FileSystem.FileExists(sSMdbName & "\Admin2.des")
        If file = False Then
            fileNum = FreeFile()
            FileOpen(fileNum, sSMdbName & "\Admin2.des", OpenMode.Output)
            i += 1
            PrintLine(fileNum, i.ToString)
            PrintLine(fileNum, "遠端電腦IP")
            PrintLine(fileNum, "127.0.0.1")
            i += 1
            PrintLine(fileNum, i.ToString)
            PrintLine(fileNum, "存放磁碟")
            PrintLine(fileNum, "C:\Program Files")
            i += 1
            PrintLine(fileNum, i.ToString)
            PrintLine(fileNum, "遠端存放磁碟")
            PrintLine(fileNum, "C:\Program Files")
            FileClose(fileNum)
        End If
        Dim s As String
        fileNum = FreeFile()
        FileOpen(fileNum, sSMdbName & "\Admin2.des", OpenMode.Input)

        'On Error Resume Next

        '1  遠端電腦IP
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        sTextBoxIP_R = (s)

        '2  存放磁碟
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        sTextBoxBpath = s

        '3  遠端存放磁碟
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        sRemoteApath = s
        sTextBoxSPARE1 = s
        FileClose(fileNum)
    End Sub
    Public Sub ReadAdmin()
        '105.7.19
        Dim file
        file = My.Computer.FileSystem.DirectoryExists(sSMdbName & "")
        If file = False Then My.Computer.FileSystem.CreateDirectory(sSMdbName & "")
        file = My.Computer.FileSystem.FileExists(sSMdbName & "\Admin.des")
        If file = False Then
            My.Computer.FileSystem.CopyFile("\JS\OrigFile\Admin.des", sSMdbName & "\Admin.des")
        End If
        Dim fileNum
        Dim s As String
        fileNum = FreeFile()
        FileOpen(fileNum, sSMdbName & "\Admin.des", OpenMode.Input)

        'On Error Resume Next
        On Error GoTo Errorhandler

        '109.2.17 for de bug
        Dim item As Integer
        item = 1

        '1  1280*960
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        bCheckBoxtTest = CBool(s)
        item = item + 1

        '2  亞東
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        bCheckBoxYadon = CBool(s)
        item = item + 1

        '3  待拌槽
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        bWaitTank = CBool(s)
        item = item + 1

        '4  Ｂ配比查詢
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        bABPB = CBool(s)
        item = item + 1

        '5  列印實際拌合時間
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        bCheckBoxMix = CBool(s)
        item = item + 1

        '6  最大拌合方數
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        fCarMaxM3 = CSng(s)
        item = item + 1

        '7  公司名稱
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        sCompany = s
        item = item + 1

        '8  專案編號
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        item = item + 1
        '105.8.6
        'sTextBoxPrj = s

        '9  英文版
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        bEngVer = CBool(s)
        item = item + 1

        '10 UniCar(X)
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        item = item + 1
        ' no use lblUniSer.Text = s

        '11 本機(X)
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        item = item + 1
        ' no use lblMachTot.Text = s

        '12 總重小數兩位
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        bCheckBoxtTot2dec = CBool(s)
        item = item + 1

        '13 校磅歸零最大值
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        fScaleZeroMax = CSng(s)
        item = item + 1

        '14 校磅校準最大值
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        fScaleSpanMax = CSng(s)
        item = item + 1

        '15 校磅校準最小值
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        fScaleSpanMin = CSng(s)
        item = item + 1

        '16 拌合機編號
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        item = item + 1
        '105.8.6 110.7.28 110.9.11
        sTextBoxMixerNo = s
        '105.8.6
        'sTextBoxMixerNo = s
        '109.5.11
        'sMixerNo = s


        '17 調度資料伺服器IP
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        sDataBaseIP = s
        item = item + 1

        '18 配比備用一
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        sTextBoxSP1 = s
        item = item + 1

        '19 配比備用二
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        sTextBoxSP2 = s
        item = item + 1

        '20 配比備用三
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        sTextBoxSP3 = s
        item = item + 1

        '21 配比備用四
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        sTextBoxSP4 = s
        item = item + 1

        '22  102.5.11   CBC7報表格式
        '112.3.25 bCheckBoxCBC7 改成列印拌合結束電流
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        bCheckBoxCBC7 = CBool(s)
        item = item + 1

        '23  102.7.15   B配米數縮減
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        bCheckBoxBPBsuben = CBool(s)
        item = item + 1

        '24  102.11.23  列印水泥註記
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        bCheckBoxCement = CBool(s)
        item = item + 1

        '25  102.12.11 廠別切換
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        bCheckBoxBack = CBool(s)
        item = item + 1

        '26  103.6.9 英制切換
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        bCheckBoxImperial = CBool(s)
        item = item + 1

        '27  103.6.9 非自動上傳
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        bCheckBoxNonAuto = CBool(s)
        item = item + 1

        '28  104.4.25 殘留值
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        bCheckBoxRemain = CBool(s)
        item = item + 1

        '29  104.4.25 SPARE1    A1-15
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        bCheckBoxSP1 = CBool(s)
        item = item + 1

        '30  104.4.25 SPARE2    日月報表寬格式
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        bCheckBoxSP2 = CBool(s)
        item = item + 1

        '31  104.4.25 SPARE3    B配存檔
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        bCheckBoxSP3 = CBool(s)
        item = item + 1

        '32  105.6.26 SPARE4    資料自動補傳
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        bCheckBoxSP4 = CBool(s)
        item = item + 1

        '33  105.6.26 SPARE5    可選遠端
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        bCheckBoxSP5 = CBool(s)
        item = item + 1

        '34  105.6.26 SPARE6    備用6
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        bCheckBoxSP6 = CBool(s)
        item = item + 1

        '35  105.6.26 SPARE7
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        bCheckBoxSP7 = CBool(s)
        item = item + 1

        '36  105.6.26 SPARE8
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        bCheckBoxSP8 = CBool(s)
        item = item + 1

        '37  105.6.26 SPARE9
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        bCheckBoxSP9 = CBool(s)
        item = item + 1

        '38  105.6.26 BPATH B存放磁碟(C:,Z:)
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        '107.7.4 disabled bead by Admin2.des 
        '107.7.9 still use Admin
        sTextBoxBpath = s
        item = item + 1

        '39  105.6.26 SPARE1    遠端A存放磁碟
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        '105.8.14 107.7.4 disabled by Admin2
        '107.7.9 still use Admin
        sRemoteApath = s
        sTextBoxSPARE1 = s
        item = item + 1

        '40  105.6.26 SPARE2
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        sTextBoxSPARE2 = s
        item = item + 1

        '41  105.6.26 SPARE3
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        '109.5.7
        If Not IsNumeric(s) Then
            s = 1000
        End If
        '108.9.12
        Dim interval As Integer
        interval = CInt(s)
        If interval < 1000 Then interval = 1000
        MainForm.TimerMoveA.Interval = interval
        sTextBoxSPARE3 = s
        item = item + 1

        '42  105.6.26 SPARE4
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        '109.5.7
        If Not IsNumeric(s) Then
            s = 1000
        End If
        interval = CInt(s)
        If interval < 1000 Then interval = 1000
        MainForm.TimerFlag.Interval = interval
        sTextBoxSPARE4 = s
        item = item + 1

        '43  105.6.26 SPARE5
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        sTextBoxSPARE5 = s
        '112.1.5
        sBigDataDataBaseIP = sTextBoxSPARE5
        '112.3.30 連接大數據資料庫
        If sTextBoxSPARE5 = "" Then
            bTextBoxSPARE5 = False
            bPingSQLBigData = False
        Else
            bTextBoxSPARE5 = True
        End If
        item = item + 1

        '44  105.7.19 遠端電腦IP
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        '107.7.4 disabled bead by Admin2.des
        '107.7.9 still use Admin
        sTextBoxIP_R = s
        item = item + 1

        '45  105.7.19 TextBoxPrj2
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        '105.8.6
        'sTextBoxPrj2 = s
        item = item + 1

        '46  105.7.19 TextBoxPrj2
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        '105.8.6 110.7.28 110.9.11
        sTextBoxMixerNo2 = s
        item = item + 1

        '47  105.7.10 SPARE10
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        bCheckBoxSP10 = CBool(s)
        item = item + 1

        '48  105.7.10 SPARE11
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        bCheckBoxSP11 = CBool(s)
        item = item + 1

        '49  105.7.10 SPARE12
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        bCheckBoxSP12 = CBool(s)
        item = item + 1

        '50  105.7.10 SPARE13
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        bCheckBoxSP13 = CBool(s)
        item = item + 1

        '51  105.7.10 SPARE14
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        bCheckBoxSP14 = CBool(s)
        item = item + 1

        '52  105.7.10 SPARE15
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        bCheckBoxSP15 = CBool(s)
        item = item + 1

        '53  107.6.10 SPARE16
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        bCheckBoxSP16 = CBool(s)
        '109.4.2 配比連線
        '112.9.18
        bPbSync = bCheckBoxSP16
        '112.9.21
        'bPbSync = False
        'If bPingSQL And bDataBaseLink Then
        '    bPbSync = bCheckBoxSP16
        'End If
        item = item + 1

        '54  107.6.10 SPARE17 109.12.19 配比15碼
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        bCheckBoxSP17 = CBool(s)
        item = item + 1

        '55  107.6.10 SPARE18   
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        bCheckBoxSP18 = CBool(s)
        item = item + 1

        '56  107.6.10 SPARE16
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        bCheckBoxSP19 = CBool(s)
        item = item + 1

        '57  107.6.10 SPARE16
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        s = LineInput(fileNum)
        bCheckBoxSP20 = CBool(s)
        item = item + 1

        FileClose(fileNum)

        Exit Sub
Errorhandler:
        MsgBox("Admin.des 內容有誤! " & item & " : " & s, MsgBoxStyle.Critical, "找不到Admin.des!")
        '105.10.8
        FileClose(fileNum)
    End Sub


    Private Sub D_20_DvChange() Handles D_20.DvChange
        '107.3.7    read D61 S1修正印出值 D91 S1印出真值 for Bone
        Dim i
        i = D_20.PV
        i = FrmMonit.ReadA2N(61, 38)
        '107.6.5
        TLog.add = " D20 Changed to " & D_20.PV & " ,Read D61.."
    End Sub

    Private Sub D_21_DvChange() Handles D_21.DvChange
        '107.3.8    read D70 W1 修正印出值 D100 W1印出真值 for Mod
        Dim i
        i = D_21.PV
        i = FrmMonit.ReadA2N(70, 44)
        '107.6.5
        TLog.add = " D21 Changed to " & D_21.PV & " ,Read D70.."
    End Sub

    Private Sub D_22_DvChange() Handles D_22.DvChange
        '107.3.8
        Dim i
        '107.4.12
        'i = D_21.PV
        i = D_22.PV
        i = FrmMonit.ReadA2N(161, 23)
        '107.6.5
        TLog.add = " D22 Changed to " & D_20.PV & " ,Read D161.."
    End Sub

    Private Sub D_32_DvChange() Handles D_32.DvChange
        Call MainForm.D32D35Change(D_32.PV, D_35.PV)
    End Sub

    Private Sub Label_PLC_D20_Label_PLC_D_Change() Handles Label_PLC_D20.Label_PLC_D_Change
        MainForm.Label_D20.Text = Label_PLC_D20.Text
    End Sub

    Private Sub Label_PLC_D21_Label_PLC_D_Change() Handles Label_PLC_D21.Label_PLC_D_Change
        MainForm.Label_D21.Text = Label_PLC_D21.Text
    End Sub
    Private Sub Label_PLC_D22_Label_PLC_D_Change() Handles Label_PLC_D22.Label_PLC_D_Change
        MainForm.Label_D22.Text = Label_PLC_D22.Text
    End Sub

    Private Sub D_01_DvChange() Handles D_01.DvChange
        Call FrmMonit.UpdatePV()
    End Sub
End Module
